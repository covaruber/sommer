<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Giovanny Covarrubias-Pazaran" />

<meta name="date" content="2020-06-25" />

<title>Quantitative genetics using the sommer package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Quantitative genetics using the sommer package</h1>
<h4 class="author">Giovanny Covarrubias-Pazaran</h4>
<h4 class="date">2020-06-25</h4>



<p>The sommer package was developed to provide R users a powerful and reliable multivariate mixed model solver for different genetic and non-genetic analysis in diploid and polyploid organisms. This package allows the user to estimate variance components for a mixed model with the advantage of specifying the variance-covariance structure of the random effects, specify heterogeneous variances, and obtain other parameters such as BLUPs, BLUEs, residuals, fitted values, variances for fixed and random effects, etc. The core algorithms of the package are coded in C++ using the Armadillo library to opmitime dense matrix operations common in the derect-inversion algorithms.</p>
<p>The package is focused on problems of the type p &gt; n related to genomic prediction (hybrid prediction &amp; genomic selection) and GWAS analysis, although any general mixed model can be fitted as well. The package provides kernels to estimate additive (<code>A.mat</code>), dominance (<code>D.mat</code>), and epistatic (<code>E.mat</code>) relationship matrices that have been shown to increase prediction accuracy under certain scenarios or simply to estimate the variance components of such. The package provides flexibility to fit other genetic models such as full and half diallel models as well.</p>
<p>Vignettes aim to provide several examples in how to use the sommer package under different scenarios. We will spend the rest of the space providing examples for:</p>
<p><strong>SECTION 1: Introduction </strong></p>
<ol style="list-style-type: decimal">
<li>Background in linear algebra</li>
</ol>
<p><strong>SECTION 2: Topics in quantitative genetics </strong></p>
<ol style="list-style-type: decimal">
<li>Heritability (<span class="math inline">\(h^2\)</span>) calculation</li>
<li>Specifying heterogeneous variances in mixed models</li>
<li>Using the pin calculator</li>
<li>Half and full diallel designs (using the overlay)</li>
<li>Genomic selection (predicting mendelian sampling)
<ul>
<li>GBLUP</li>
<li>rrBLUP</li>
</ul></li>
<li>Single cross prediction (hybrid prediction)</li>
<li>Spatial modeling (using the 2-dimensional splines)</li>
<li>Multivariate genetic models and genetic correlations</li>
<li>Final remarks</li>
</ol>
<p><strong>SECTION 3: Special topics in quantitative genetics</strong></p>
<ol style="list-style-type: decimal">
<li>Partitioned model</li>
<li>UDU’ decomposition</li>
<li>Mating designs</li>
<li>Dominance variance</li>
</ol>
<div id="section-1-introduction" class="section level2">
<h2>SECTION 1: Introduction</h2>
<div id="backgrounds-in-linear-algebra" class="section level3">
<h3>Backgrounds in linear algebra</h3>
<p>The core of the package the <code>mmer</code>function which solve the mixed model equations. The functions are an interface to call the <code>NR</code> Direct-Inversion Newton-Raphson or Average Information (Tunnicliffe 1989; Gilmour et al. 1995; Lee et al. 2016). Since version 2.0 sommer can handle multivariate models. Following Maier et al. (2015), the multivariate (and by extension the univariate) mixed model implemented has the form:</p>
<p><br></p>
<p><span class="math inline">\(y_1 = X_1\beta_1 + Z_1u_1 + \epsilon_1\)</span> <span class="math inline">\(y_2 = X_2\beta_2 + Z_2u_2 + \epsilon_2\)</span> … <span class="math inline">\(y_i = X_i\beta_i + Z_iu_i + \epsilon_i\)</span></p>
<p><br></p>
<p>where <span class="math inline">\(y_i\)</span> is a vector of trait phenotypes, <span class="math inline">\(\beta_i\)</span> is a vector of fixed effects, <span class="math inline">\(u_i\)</span> is a vector of random effects for individuals and <span class="math inline">\(e_i\)</span> are residuals for trait ‘i’ (i = 1, …, t). The random effects (<span class="math inline">\(u_1\)</span> … <span class="math inline">\(u_i\)</span> and <span class="math inline">\(e_i\)</span>) are assumed to be normally distributed with mean zero. X and Z are incidence matrices for fixed and random effects respectively. The distribution of the multivariate response and the phenotypic variance covariance (V) are:</p>
<p><br></p>
<p><span class="math inline">\(Y = X\beta + ZU + \epsilon_i\)</span></p>
<p><br></p>
<p>Y ~ MVN(<span class="math inline">\(X\beta\)</span>, V)</p>
<p><br></p>
<p><span class="math display">\[\mathbf{Y} = \left[\begin{array}
{r}
y_1 \\
y_2 \\
... \\
y_t \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p><span class="math display">\[\mathbf{X} = \left[\begin{array}
{rrr}
X_1 &amp; ... &amp; ... \\
\vdots &amp; \ddots &amp; \vdots\\
... &amp; ... &amp; X_t \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p><span class="math display">\[\mathbf{V} = \left[\begin{array}
{rrr}
Z_1 K{\sigma^2_{g_{1}}} Z_1&#39; + H{\sigma^2_{\epsilon_{1}}} &amp; ... &amp; Z_1 K{\sigma_{g_{1,t}}} Z_t&#39; + H{\sigma_{\epsilon_{1,t}}}\\
 \vdots &amp; \ddots &amp; \vdots\\
Z_1 K{\sigma_{g_{1,t}}} Z_t&#39; + H{\sigma_{\epsilon_{1,t}}} &amp; ... &amp; Z_t K{\sigma^2_{g_{t}}} Z_t&#39; + H{\sigma^2_{\epsilon_{t}}} \\
\end{array}\right]
\]</span></p>
<p><br></p>
<p>where K is the relationship or covariance matrix for the kth random effect (u=1,…,k), and R=I is an identity matrix for the residual term. The terms <span class="math inline">\(\sigma^2_{g_{i}}\)</span> and <span class="math inline">\(\sigma^2_{\epsilon_{i}}\)</span> denote the genetic (or any of the kth random terms) and residual variance of trait ‘i’, respectively and <span class="math inline">\(\sigma_{g_{_{ij}}}\)</span> and <span class="math inline">\(\sigma_{\epsilon_{_{ij}}}\)</span> the genetic (or any of the kth random terms) and residual covariance between traits ‘i’ and ‘j’ (i=1,…,t, and j=1,…,t). The algorithm implemented optimizes the log likelihood:</p>
<p><br></p>
<p><span class="math inline">\(logL = 1/2 * ln(|V|) + ln(X&#39;|V|X) + Y&#39;PY\)</span></p>
<p><br></p>
<p>where || is the determinant of a matrix. And the REML estimates are updated using a Newton optimization algorithm of the form:</p>
<p><br></p>
<p><span class="math inline">\(\theta^{k+1} = \theta^{k} + (H^{k})^{-1}*\frac{dL}{d\sigma^2_i}|\theta^k\)</span></p>
<p><br></p>
<p>Where, <span class="math inline">\(\theta\)</span> is the vector of variance components for random effects and covariance components among traits, <span class="math inline">\(H^{-1}\)</span> is the inverse of the Hessian matrix of second derivatives for the kth cycle, <span class="math inline">\(\frac{dL}{d\sigma^2_i}\)</span> is the vector of first derivatives of the likelihood with respect to the variance-covariance components. The Eigen decomposition of the relationship matrix proposed by Lee and Van Der Werf (2016) was included in the Newton-Raphson algorithm to improve time efficiency. Additionally, the popular pin function to estimate standard errors for linear combinations of variance components (i.e. heritabilities and genetic correlations) was added to the package as well.</p>
<p>Please refer to the canonical papers listed in the Literature section to check how the algorithms work. We have tested widely the methods to make sure they provide the same solution when the likelihood behaves well but for complex problems they might lead to slightly different answers. If you have any concern please contact me at <a href="mailto:cova_ruber@live.com.mx" class="email">cova_ruber@live.com.mx</a>.</p>
<p>In the following section we will go in detail over several examples on how to use mixed models in univariate and multivariate case and their use in quantitative genetics.</p>
<p><br></p>
</div>
</div>
<div id="section-2-topics-in-quantitative-genetics" class="section level2">
<h2>SECTION 2: Topics in quantitative genetics</h2>
<div id="marker-and-non-marker-based-heritability-calculation" class="section level3">
<h3>1) Marker and non-marker based heritability calculation</h3>
<p>The heritability is one of the most popular parameters among the breeding and genetics community because of the insight that provides in the inheritance of the trait. The heritability is usually estimated as narrow sense (<span class="math inline">\(h^2\)</span>; only additive variance in the numerator <span class="math inline">\(\sigma^2_A\)</span>), and broad sense (<span class="math inline">\(H^2\)</span>; all genetic variance in the numerator <span class="math inline">\(\sigma^2_G\)</span>).</p>
<p>In a classical breeding experiment with no molecular markers, special designs are performed to estimate and disect the additive (<span class="math inline">\(\sigma^2_A\)</span>) and non-additive (i.e. dominance <span class="math inline">\(\sigma^2_D\)</span>) variance along with environmental variability. Designs such as generation analysis, North Carolina designs are used to disect <span class="math inline">\(\sigma^2_A\)</span> and <span class="math inline">\(\sigma^2_D\)</span> to estimate the narrow sense heritability (<span class="math inline">\(h^2\)</span>). When no special design is available we can still disect the genetic variance (<span class="math inline">\(\sigma^2_G\)</span>) and estimate the broad sense heritability. In this first example we will show the broad sense estimation which doesn’t use covariance structures for the genotipic effect (i.e. genomic or additive relationship matrices). For big models with no covariance structures, sommer’s direct inversion is a bad idea to use but we will show anyways how to do it, but keep in mind that for very sparse models we recommend using the lmer function from the lme4 package or any other package using MME-based algorithms (i.e. asreml-R).</p>
<p>The following dataset has 41 potato lines evaluated in 5 locations across 3 years in an RCBD design. We show how to fit the model and extract the variance components to calculate the <span class="math inline">\(h^2\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(sommer)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: crayon</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">data</span>(DT_example)</span>
<span id="cb6-2"><a href="#cb6-2"></a>DT &lt;-<span class="st"> </span>DT_example</span>
<span id="cb6-3"><a href="#cb6-3"></a>A &lt;-<span class="st"> </span>A_example</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>ans1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>             <span class="dt">random=</span> <span class="op">~</span><span class="st"> </span>Name <span class="op">+</span><span class="st"> </span>Env <span class="op">+</span><span class="st"> </span>Env<span class="op">:</span>Name <span class="op">+</span><span class="st"> </span>Env<span class="op">:</span>Block,</span>
<span id="cb6-7"><a href="#cb6-7"></a>             <span class="dt">rcov=</span> <span class="op">~</span><span class="st"> </span>units,</span>
<span id="cb6-8"><a href="#cb6-8"></a>             <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -40.765   17:15:1      0           0
##     2      -30.2657   17:15:1      0           0
##     3      -25.8227   17:15:1      0           1
##     4      -24.7277   17:15:1      0           1
##     5      -24.7203   17:15:1      0           1
##     6      -24.7202   17:15:1      0           1</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">summary</span>(ans1)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                         VarComp  VarCompSE    Zratio Constraint
## Name.Yield-Yield       3.718279  1.6959834 2.1924029   Positive
## Env.Yield-Yield       12.008450 12.2771178 0.9781164   Positive
## Env:Name.Yield-Yield   5.152643  1.4923912 3.4526091   Positive
## Env:Block.Yield-Yield  0.000000  0.1156675 0.0000000   Positive
## units.Yield-Yield      4.366189  0.6573086 6.6425245   Positive</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>(n.env &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(DT<span class="op">$</span>Env)))</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">pin</span>(ans1, h2 <span class="op">~</span><span class="st"> </span>V1 <span class="op">/</span><span class="st"> </span>( V1 <span class="op">+</span><span class="st"> </span>(V3<span class="op">/</span>n.env) <span class="op">+</span><span class="st"> </span>(V5<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n.env)) ) )</span></code></pre></div>
<pre><code>##     Estimate        SE
## h2 0.6032715 0.1344582</code></pre>
<p>Recently with markers becoming cheaper, thousand of markers can be run in the breeding materials. When markers are available, an special design is not neccesary to disect the additive genetic variance. The availability of the additive, dominance and epistatic relationship matrices allow us to estimate <span class="math inline">\(\sigma^2_A\)</span>, <span class="math inline">\(\sigma^2_D\)</span> and <span class="math inline">\(\sigma^2_I\)</span>, although given that A, D and E are not orthogonal the interpretation of models that fit more than A and D become cumbersome.</p>
<p>Assume you have a population (even unreplicated) in the field but in addition we have genetic markers. Now we can fit the model and estimate the genomic heritability that explains a portion of the additive genetic variance (with high marker density <span class="math inline">\(\sigma^2_A\)</span> = <span class="math inline">\(\sigma^2_g\)</span>)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">data</span>(DT_cpdata)</span>
<span id="cb14-2"><a href="#cb14-2"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb14-3"><a href="#cb14-3"></a>GT &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb14-4"><a href="#cb14-4"></a>MP &lt;-<span class="st"> </span>MP_cpdata</span>
<span id="cb14-5"><a href="#cb14-5"></a>DT<span class="op">$</span>idd &lt;-DT<span class="op">$</span>id; DT<span class="op">$</span>ide &lt;-DT<span class="op">$</span>id</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">### look at the data</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>D &lt;-<span class="st"> </span><span class="kw">D.mat</span>(GT) <span class="co"># dominance relationship matrix</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>E &lt;-<span class="st"> </span><span class="kw">E.mat</span>(GT) <span class="co"># epistatic relationship matrix</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>ans.ADE &lt;-<span class="st"> </span><span class="kw">mmer</span>(color<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb14-11"><a href="#cb14-11"></a>                 <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A) <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(idd,<span class="dt">Gu=</span>D), </span>
<span id="cb14-12"><a href="#cb14-12"></a>                 <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb14-13"><a href="#cb14-13"></a>                 <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -123   17:15:3      0           0
##     2      -107.864   17:15:3      0           0
##     3      -103.867   17:15:3      0           0
##     4      -103.315   17:15:3      0           0
##     5      -103.294   17:15:3      0           0
##     6      -103.293   17:15:3      0           0</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>(<span class="kw">summary</span>(ans.ADE)<span class="op">$</span>varcomp)</span></code></pre></div>
<pre><code>##                       VarComp    VarCompSE   Zratio Constraint
## u:id.color-color  0.003662202 0.0012194130 3.003250   Positive
## u:idd.color-color 0.001820079 0.0007406216 2.457502   Positive
## units.color-color 0.002106929 0.0002864724 7.354736   Positive</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">pin</span>(ans.ADE, h2 <span class="op">~</span><span class="st"> </span>(V1) <span class="op">/</span><span class="st"> </span>( V1<span class="op">+</span>V3) )</span></code></pre></div>
<pre><code>##     Estimate         SE
## h2 0.6347926 0.08840488</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">pin</span>(ans.ADE, h2 <span class="op">~</span><span class="st"> </span>(V1<span class="op">+</span>V2) <span class="op">/</span><span class="st"> </span>( V1<span class="op">+</span>V2<span class="op">+</span>V3) )</span></code></pre></div>
<pre><code>##     Estimate         SE
## h2 0.7223783 0.05563774</code></pre>
<p>In the previous example we showed how to estimate the additive (<span class="math inline">\(\sigma^2_A\)</span>), dominance (<span class="math inline">\(\sigma^2_D\)</span>), and epistatic (<span class="math inline">\(\sigma^2_I\)</span>) variance components based on markers and estimate broad (<span class="math inline">\(H^2\)</span>) and narrow sense heritability (<span class="math inline">\(h^2\)</span>). Notice that we used the <code>vs()</code> function which indicates that the random effect inside the parenthesis (i.e. id, idd or ide) has a covariance matrix (A, D, or E), that will be specified in the Gu argument of the vs() function. Please DO NOT provide the inverse but the original covariance matrix.</p>
</div>
<div id="specifying-heterogeneous-variances-in-univariate-models" class="section level3">
<h3>2) Specifying heterogeneous variances in univariate models</h3>
<p>Very often in multi-environment trials, the assumption that genetic variance is the same across locations may be too naive. Because of that, specifying a general genetic component and a location specific genetic variance is the way to go.</p>
<p>We estimate variance components for <span class="math inline">\(GCA_2\)</span> and <span class="math inline">\(SCA\)</span> specifying the variance structure.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">data</span>(DT_cornhybrids)</span>
<span id="cb22-2"><a href="#cb22-2"></a>DT &lt;-<span class="st"> </span>DT_cornhybrids</span>
<span id="cb22-3"><a href="#cb22-3"></a>DTi &lt;-<span class="st"> </span>DTi_cornhybrids</span>
<span id="cb22-4"><a href="#cb22-4"></a>GT &lt;-<span class="st"> </span>GT_cornhybrids</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">### fit the model</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>modFD &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb22-7"><a href="#cb22-7"></a>               <span class="dt">random=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(<span class="kw">at</span>(Location,<span class="kw">c</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>)),GCA2), </span>
<span id="cb22-8"><a href="#cb22-8"></a>               <span class="dt">rcov=</span> <span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Location),units),</span>
<span id="cb22-9"><a href="#cb22-9"></a>               <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -190.104   17:15:3      0           0
##     2      -171.543   17:15:3      0           0
##     3      -165.319   17:15:3      0           0
##     4      -164.691   17:15:4      1           0
##     5      -164.684   17:15:4      1           0
##     6      -164.684   17:15:4      1           0</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">summary</span>(modFD)</span></code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 4.1  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -164.6839 331.3677 335.3592     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                     VarComp VarCompSE Zratio Constraint
## 3:GCA2.Yield-Yield    62.48     53.45  1.169   Positive
## 4:GCA2.Yield-Yield    97.99     79.56  1.232   Positive
## 1:units.Yield-Yield  216.82     30.77  7.047   Positive
## 2:units.Yield-Yield  216.82     30.77  7.047   Positive
## 3:units.Yield-Yield  493.05     77.27  6.381   Positive
## 4:units.Yield-Yield  711.98    111.63  6.378   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    138.1    0.9442   146.3
## ============================================================
## Groups and observations:
##        Yield
## 3:GCA2    20
## 4:GCA2    20
## ============================================================
## Use the &#39;$&#39; sign to access results and parameters</code></pre>
<p>In the previous example we showed how the <code>at()</code> function is used in the <code>mmer</code> solver. By using the <code>at</code> function you can specify that i.e. the GCA2 has a different variance in different Locations, in this case locations 3 and 4, but also a main GCA variance. This is considered a CS + DIAG (compound symmetry + diagonal) model.</p>
<p>In addition, other functions can be added on top to fit models with covariance structures, i.e. the Gu argument from the <code>vs()</code> function to indicate a covariance matrix (A, pedigree or genomic relationship matrix)</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">data</span>(DT_cornhybrids)</span>
<span id="cb26-2"><a href="#cb26-2"></a>DT &lt;-<span class="st"> </span>DT_cornhybrids</span>
<span id="cb26-3"><a href="#cb26-3"></a>DTi &lt;-<span class="st"> </span>DTi_cornhybrids</span>
<span id="cb26-4"><a href="#cb26-4"></a>GT &lt;-<span class="st"> </span>GT_cornhybrids</span>
<span id="cb26-5"><a href="#cb26-5"></a>GT[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>##             A258       A634        A641        A680
## A258  2.23285528 -0.3504778 -0.04756856 -0.32239362
## A634 -0.35047780  1.4529169  0.45203869 -0.02293680
## A641 -0.04756856  0.4520387  1.96940221 -0.09896791
## A680 -0.32239362 -0.0229368 -0.09896791  1.65221984</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">### fit the model</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>modFD &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb28-3"><a href="#cb28-3"></a>              <span class="dt">random=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(<span class="kw">at</span>(Location,<span class="kw">c</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>)),GCA2,<span class="dt">Gu=</span>GT), </span>
<span id="cb28-4"><a href="#cb28-4"></a>              <span class="dt">rcov=</span> <span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(<span class="kw">ds</span>(Location),units),</span>
<span id="cb28-5"><a href="#cb28-5"></a>              <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -191.286   17:15:4      0           0
##     2      -172.247   17:15:4      0           0
##     3      -165.948   17:15:4      0           0
##     4      -165.248   17:15:4      0           0
##     5      -165.23   17:15:4      0           0
##     6      -165.229   17:15:4      0           0
##     7      -165.229   17:15:4      0           0</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">summary</span>(modFD)</span></code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 4.1  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -165.2286 332.4571 336.4486     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                     VarComp VarCompSE Zratio Constraint
## 3:GCA2.Yield-Yield    26.64     26.16 1.0185   Positive
## 4:GCA2.Yield-Yield    37.51     37.78 0.9927   Positive
## 1:units.Yield-Yield  216.77     30.75 7.0489   Positive
## 2:units.Yield-Yield  216.77     30.75 7.0489   Positive
## 3:units.Yield-Yield  503.62     77.87 6.4673   Positive
## 4:units.Yield-Yield  738.86    114.17 6.4715   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    138.1    0.9147     151
## ============================================================
## Groups and observations:
##        Yield
## 3:GCA2    20
## 4:GCA2    20
## ============================================================
## Use the &#39;$&#39; sign to access results and parameters</code></pre>
</div>
<div id="using-the-pin-calculator" class="section level3">
<h3>3) Using the pin calculator</h3>
<p>Sometimes the user needs to calculate ratios or functions of specific variance-covariance components and obtain the standard error for such parameters. Examples of these are the genetic correlations, heritabilities, etc. Using the CPdata we will show how to estimate the heritability and the standard error using the pin function that uses the delta method to come up with these parameters. This can be extended for any linear combination of the variance components.</p>
<div id="standar-error-for-heritability" class="section level4">
<h4>3.1) Standar error for heritability</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">data</span>(DT_cpdata)</span>
<span id="cb32-2"><a href="#cb32-2"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb32-3"><a href="#cb32-3"></a>GT &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb32-4"><a href="#cb32-4"></a>MP &lt;-<span class="st"> </span>MP_cpdata</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">### look at the data</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>ans &lt;-<span class="st"> </span><span class="kw">mmer</span>(color<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb32-8"><a href="#cb32-8"></a>                <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A), </span>
<span id="cb32-9"><a href="#cb32-9"></a>                <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb32-10"><a href="#cb32-10"></a>                <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -137.304   17:15:5      0           0
##     2      -115.507   17:15:5      0           0
##     3      -111.236   17:15:5      0           0
##     4      -110.755   17:15:5      0           0
##     5      -110.741   17:15:5      0           0
##     6      -110.741   17:15:5      0           0</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>(<span class="kw">summary</span>(ans.ADE)<span class="op">$</span>varcomp)</span></code></pre></div>
<pre><code>##                       VarComp    VarCompSE   Zratio Constraint
## u:id.color-color  0.003662202 0.0012194130 3.003250   Positive
## u:idd.color-color 0.001820079 0.0007406216 2.457502   Positive
## units.color-color 0.002106929 0.0002864724 7.354736   Positive</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">pin</span>(ans, h2 <span class="op">~</span><span class="st"> </span>(V1) <span class="op">/</span><span class="st"> </span>( V1<span class="op">+</span>V2) )</span></code></pre></div>
<pre><code>##     Estimate         SE
## h2 0.6512157 0.06107574</code></pre>
<p>The same can be used for multivariate models. Please check the documentation of the <code>pin</code> function to see more examples.</p>
</div>
<div id="standar-error-for-genetic-correlation" class="section level4">
<h4>3.2) Standar error for genetic correlation</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">data</span>(DT_btdata)</span>
<span id="cb38-2"><a href="#cb38-2"></a>DT &lt;-<span class="st"> </span>DT_btdata</span>
<span id="cb38-3"><a href="#cb38-3"></a>mix3 &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(tarsus, back) <span class="op">~</span><span class="st"> </span>sex,</span>
<span id="cb38-4"><a href="#cb38-4"></a>               <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(dam, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(fosternest,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>)),</span>
<span id="cb38-5"><a href="#cb38-5"></a>               <span class="dt">rcov=</span><span class="op">~</span><span class="kw">vs</span>(units,<span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)),</span>
<span id="cb38-6"><a href="#cb38-6"></a>               <span class="dt">data =</span> DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -934.205   17:15:10      5           0
##     2      -745.644   17:15:14      9           0
##     3      -661.568   17:15:18      13           0
##     4      -652.061   17:15:22      17           0
##     5      -651.67   17:15:26      21           0
##     6      -651.605   17:15:30      25           0
##     7      -651.591   17:15:35      30           0
##     8      -651.587   17:15:41      36           0
##     9      -651.586   17:15:46      41           0</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">summary</span>(mix3)</span></code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 4.1  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -651.5865 1315.173 1347.646     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                             VarComp VarCompSE Zratio Constraint
## u:dam.tarsus-tarsus         0.21847   0.04743  4.606   Positive
## u:dam.tarsus-back          -0.03618   0.02644 -1.369   Unconstr
## u:dam.back-back             0.05973   0.03073  1.944   Positive
## u:fosternest.tarsus-tarsus  0.07304   0.02891  2.526   Positive
## u:fosternest.back-back      0.13158   0.03890  3.383   Positive
## u:units.tarsus-tarsus       0.56699   0.03082 18.397   Positive
## u:units.tarsus-back        -0.03004   0.02581 -1.164   Unconstr
## u:units.back-back           0.80494   0.04361 18.459   Positive
## ============================================================
## Fixed effects:
##    Trait      Effect Estimate Std.Error t.value
## 1 tarsus (Intercept) -0.40631   0.06720 -6.0466
## 2   back (Intercept) -0.01459   0.06489 -0.2248
## 3 tarsus     sexMale  0.76905   0.05711 13.4670
## 4   back     sexMale  0.01057   0.06704  0.1577
## 5 tarsus      sexUNK  0.21231   0.12665  1.6763
## 6   back      sexUNK  0.09976   0.14794  0.6743
## ============================================================
## Groups and observations:
##              tarsus back
## u:dam           106  106
## u:fosternest    104  104
## ============================================================
## Use the &#39;$&#39; sign to access results and parameters</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#### calculate the genetic correlation</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">pin</span>(mix3, gen.cor <span class="op">~</span><span class="st"> </span>V2 <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(V1<span class="op">*</span>V3))</span></code></pre></div>
<pre><code>##           Estimate        SE
## gen.cor -0.3167271 0.2228247</code></pre>
</div>
</div>
<div id="half-and-full-diallel-designs-use-of-the-overlay" class="section level3">
<h3>4) Half and full diallel designs (use of the overlay)</h3>
<p>When breeders are looking for the best single cross combinations, diallel designs have been by far the most used design in crops like maize. There are 4 types of diallel designs depending if reciprocate and self cross (omission of parents) are performed (full diallel with parents n^2; full diallel without parents n(n-1); half diallel with parents 1/2 * n(n+1); half diallel without parents 1/2 * n(n-1) ). In this example we will show a full dialle design (reciprocate crosses are performed) and half diallel designs (only one of the directions is performed).</p>
<p>In the first data set we show a full diallel among 40 lines from 2 heterotic groups, 20 in each. Therefore 400 possible hybrids are possible. We have pehnotypic data for 100 of them across 4 locations. We use the data available to fit a model of the form:</p>
<p><br></p>
<p><span class="math inline">\(y = X\beta + Zu_1 + Zu_2 + Zu_S + \epsilon\)</span></p>
<p><br></p>
<p>We estimate variance components for <span class="math inline">\(GCA_1\)</span>, <span class="math inline">\(GCA_2\)</span> and <span class="math inline">\(SCA\)</span> and use them to estimate heritability. Additionally BLUPs for GCA and SCA effects can be used to predict crosses.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">data</span>(DT_cornhybrids)</span>
<span id="cb44-2"><a href="#cb44-2"></a>DT &lt;-<span class="st"> </span>DT_cornhybrids</span>
<span id="cb44-3"><a href="#cb44-3"></a>DTi &lt;-<span class="st"> </span>DTi_cornhybrids</span>
<span id="cb44-4"><a href="#cb44-4"></a>GT &lt;-<span class="st"> </span>GT_cornhybrids</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a>modFD &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span>Location, </span>
<span id="cb44-7"><a href="#cb44-7"></a>               <span class="dt">random=</span><span class="op">~</span>GCA1<span class="op">+</span>GCA2<span class="op">+</span>SCA, </span>
<span id="cb44-8"><a href="#cb44-8"></a>               <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb44-9"><a href="#cb44-9"></a>               <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -149.436   17:15:48      0           0
##     2      -136.475   17:15:48      0           1
##     3      -132.852   17:15:48      0           1
##     4      -132.625   17:15:48      0           1
##     5      -132.596   17:15:48      0           1
##     6      -132.59   17:15:48      0           1
##     7      -132.589   17:15:48      0           1
##     8      -132.589   17:15:48      0           1</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>(suma &lt;-<span class="st"> </span><span class="kw">summary</span>(modFD)<span class="op">$</span>varcomp)</span></code></pre></div>
<pre><code>##                      VarComp VarCompSE     Zratio Constraint
## GCA1.Yield-Yield    0.000000  16.50337  0.0000000   Positive
## GCA2.Yield-Yield    7.412226  18.94200  0.3913116   Positive
## SCA.Yield-Yield   187.560303  41.59428  4.5092817   Positive
## units.Yield-Yield 221.142463  18.14716 12.1860656   Positive</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>Vgca &lt;-<span class="st"> </span><span class="kw">sum</span>(suma[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">1</span>])</span>
<span id="cb48-2"><a href="#cb48-2"></a>Vsca &lt;-<span class="st"> </span>suma[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb48-3"><a href="#cb48-3"></a>Ve &lt;-<span class="st"> </span>suma[<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb48-4"><a href="#cb48-4"></a>Va =<span class="st"> </span><span class="dv">4</span><span class="op">*</span>Vgca</span>
<span id="cb48-5"><a href="#cb48-5"></a>Vd =<span class="st"> </span><span class="dv">4</span><span class="op">*</span>Vsca</span>
<span id="cb48-6"><a href="#cb48-6"></a>Vg &lt;-<span class="st"> </span>Va <span class="op">+</span><span class="st"> </span>Vd</span>
<span id="cb48-7"><a href="#cb48-7"></a>(H2 &lt;-<span class="st"> </span>Vg <span class="op">/</span><span class="st"> </span>(Vg <span class="op">+</span><span class="st"> </span>(Ve)) )</span></code></pre></div>
<pre><code>## [1] 0.7790856</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>(h2 &lt;-<span class="st"> </span>Va <span class="op">/</span><span class="st"> </span>(Vg <span class="op">+</span><span class="st"> </span>(Ve)) )</span></code></pre></div>
<pre><code>## [1] 0.02961832</code></pre>
<p>Don’t worry too much about the small h2 value, the data was simulated to be mainly dominance variance, therefore the Va was simulated extremely small leading to such value of narrow sense h2.</p>
<p>In this second data set we show a small half diallel with 7 parents crossed in one direction. n(n-1)/2 crosses are possible 7(6)/2 = 21 unique crosses. Parents appear as males or females indistictly. Each with two replications in a CRD. For a half diallel design a single GCA variance component for both males and females can be estimated and an SCA as well (<span class="math inline">\(\sigma^2_GCA\)</span> and <span class="math inline">\(\sigma^2_SCA\)</span> respectively), and BLUPs for GCA and SCA of the parents can be extracted. We would show first how to use it with the <code>mmer</code> function using the <code>overlay()</code> function. The specific model here is:</p>
<p><span class="math inline">\(y = X\beta + Zu_g + Zu_s + \epsilon\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">data</span>(<span class="st">&quot;DT_halfdiallel&quot;</span>)</span>
<span id="cb52-2"><a href="#cb52-2"></a>DT &lt;-<span class="st"> </span>DT_halfdiallel</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="kw">head</span>(DT)</span></code></pre></div>
<pre><code>##   rep geno male female     sugar
## 1   1   12    1      2 13.950509
## 2   2   12    1      2  9.756918
## 3   1   13    1      3 13.906355
## 4   2   13    1      3  9.119455
## 5   1   14    1      4  5.174483
## 6   2   14    1      4  8.452221</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>DT<span class="op">$</span>femalef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>female)</span>
<span id="cb54-2"><a href="#cb54-2"></a>DT<span class="op">$</span>malef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>male)</span>
<span id="cb54-3"><a href="#cb54-3"></a>DT<span class="op">$</span>genof &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>geno)</span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="co">#### model using overlay</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>modh &lt;-<span class="st"> </span><span class="kw">mmer</span>(sugar<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb54-6"><a href="#cb54-6"></a>             <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(<span class="kw">overlay</span>(femalef,malef)) </span>
<span id="cb54-7"><a href="#cb54-7"></a>             <span class="op">+</span><span class="st"> </span>genof,</span>
<span id="cb54-8"><a href="#cb54-8"></a>             <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -10.425   17:15:49      0           0
##     2      -6.487   17:15:49      0           0
##     3      -5.732   17:15:49      0           0
##     4      -5.67494   17:15:49      0           0
##     5      -5.67441   17:15:49      0           0</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">summary</span>(modh)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                        VarComp VarCompSE   Zratio Constraint
## u:femalef.sugar-sugar 5.507899 3.5741151 1.541052   Positive
## genof.sugar-sugar     1.815784 1.3629575 1.332238   Positive
## units.sugar-sugar     3.117538 0.9626094 3.238632   Positive</code></pre>
<p>Notice how the <code>overlay()</code> argument makes the overlap of incidence matrices possible making sure that male and female are joint into a single random effect.</p>
</div>
<div id="genomic-selection-predicting-mendelian-sampling" class="section level3">
<h3>5) Genomic selection: predicting mendelian sampling</h3>
<p>In this section we will use wheat data from CIMMYT to show how is genomic selection performed. This is the case of prediction of specific individuals within a population. It basically uses a similar model of the form:</p>
<p><br></p>
<p><span class="math inline">\(y = X\beta + Zu + \epsilon\)</span></p>
<p><br></p>
<p>and takes advantage of the variance covariance matrix for the genotype effect known as the additive relationship matrix (A) and calculated using the <code>A.mat</code> function to establish connections among all individuals and predict the BLUPs for individuals that were not measured. The prediction accuracy depends on several factors such as the heritability (<span class="math inline">\(h^2\)</span>), training population used (TP), size of TP, etc.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">data</span>(DT_wheat)</span>
<span id="cb58-2"><a href="#cb58-2"></a>DT &lt;-<span class="st"> </span>DT_wheat</span>
<span id="cb58-3"><a href="#cb58-3"></a>GT &lt;-<span class="st"> </span>GT_wheat</span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="kw">colnames</span>(DT) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(DT))</span>
<span id="cb58-5"><a href="#cb58-5"></a>DT &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(DT);DT<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">rownames</span>(DT))</span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="co"># select environment 1</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="kw">rownames</span>(GT) &lt;-<span class="st"> </span><span class="kw">rownames</span>(DT)</span>
<span id="cb58-8"><a href="#cb58-8"></a>K &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span></span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="kw">colnames</span>(K) &lt;-<span class="st"> </span><span class="kw">rownames</span>(K) &lt;-<span class="st"> </span><span class="kw">rownames</span>(DT)</span>
<span id="cb58-10"><a href="#cb58-10"></a><span class="co"># GBLUP pedigree-based approach</span></span>
<span id="cb58-11"><a href="#cb58-11"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-12"><a href="#cb58-12"></a>y.trn &lt;-<span class="st"> </span>DT</span>
<span id="cb58-13"><a href="#cb58-13"></a>vv &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rownames</span>(DT),<span class="kw">round</span>(<span class="kw">nrow</span>(DT)<span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb58-14"><a href="#cb58-14"></a>y.trn[vv,<span class="st">&quot;X1&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb58-15"><a href="#cb58-15"></a><span class="kw">head</span>(y.trn)</span></code></pre></div>
<pre><code>##              X1          X2          X3         X4   id
## 775   1.6716295 -1.72746986 -1.89028479  0.0509159  775
## 2166 -0.2527028  0.40952243  0.30938553 -1.7387588 2166
## 2167         NA -0.64862633 -0.79955921 -1.0535691 2167
## 2465  0.7854395  0.09394919  0.57046773  0.5517574 2465
## 3881  0.9983176 -0.28248062  1.61868192 -0.1142848 3881
## 3889  2.3360969  0.62647587  0.07353311  0.7195856 3889</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co">## GBLUP</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>ans &lt;-<span class="st"> </span><span class="kw">mmer</span>(X1<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb60-3"><a href="#cb60-3"></a>            <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>K), </span>
<span id="cb60-4"><a href="#cb60-4"></a>            <span class="dt">rcov=</span><span class="op">~</span>units, </span>
<span id="cb60-5"><a href="#cb60-5"></a>            <span class="dt">data=</span>y.trn) <span class="co"># kinship based</span></span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -207.28   17:15:50      0           0
##     2      -204.823   17:15:50      0           0
##     3      -203.988   17:15:50      0           0
##     4      -203.866   17:15:50      0           0
##     5      -203.862   17:15:50      0           0
##     6      -203.861   17:15:50      0           0</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>ans<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X1 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(ans<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X1)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">rownames</span>(ans<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X1) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">rownames</span>(ans<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X1))</span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="kw">cor</span>(ans<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X1[vv,],DT[vv,<span class="st">&quot;X1&quot;</span>], <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.5737594</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co">## rrBLUP</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>ans2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(X1<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb64-3"><a href="#cb64-3"></a>             <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(<span class="kw">list</span>(GT)), </span>
<span id="cb64-4"><a href="#cb64-4"></a>             <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb64-5"><a href="#cb64-5"></a>             <span class="dt">data=</span>y.trn) <span class="co"># kinship based</span></span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -351.655   17:15:52      1           0
##     2      -249.864   17:15:52      1           0
##     3      -214.384   17:15:53      2           0
##     4      -204.423   17:15:53      2           0
##     5      -203.883   17:15:53      2           0
##     6      -203.862   17:15:53      2           0
##     7      -203.861   17:15:53      2           0</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>u &lt;-<span class="st"> </span>GT <span class="op">%*%</span><span class="st"> </span><span class="kw">as.matrix</span>(ans2<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:GT</span><span class="st">`</span><span class="op">$</span>X1) <span class="co"># BLUPs for individuals</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="kw">rownames</span>(u) &lt;-<span class="st"> </span><span class="kw">rownames</span>(GT)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="kw">cor</span>(u[vv,],DT[vv,<span class="st">&quot;X1&quot;</span>]) <span class="co"># same correlation</span></span></code></pre></div>
<pre><code>## [1] 0.5737681</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># the same can be applied in multi-response models in GBLUP or rrBLUP</span></span></code></pre></div>
</div>
<div id="genomic-selection-single-cross-prediction" class="section level3">
<h3>6) Genomic selection: single cross prediction</h3>
<p>When doing prediction of single cross performance the phenotype can be dissected in three main components, the general combining abilities (GCA) and specific combining abilities (SCA). This can be expressed with the same model analyzed in the diallel experiment mentioned before:</p>
<p><br></p>
<p><span class="math inline">\(y = X\beta + Zu_1 + Zu_2 + Zu_S + \epsilon\)</span></p>
<p><br></p>
<p>with:</p>
<p><br></p>
<p><span class="math inline">\(u_1\)</span> ~ N(0, <span class="math inline">\(K_1\)</span><span class="math inline">\(\sigma^2_u1\)</span>)</p>
<p><span class="math inline">\(u_2\)</span> ~ N(0, <span class="math inline">\(K_2\)</span><span class="math inline">\(\sigma^2_u2\)</span>)</p>
<p><span class="math inline">\(u_s\)</span> ~ N(0, <span class="math inline">\(K_3\)</span><span class="math inline">\(\sigma^2_us\)</span>)</p>
<p><br></p>
<p>And we can specify the K matrices. The main difference between this model and the full and half diallel designs is the fact that this model will include variance covariance structures in each of the three random effects (GCA1, GCA2 and SCA) to be able to predict the crosses that have not ocurred yet. We will use the data published by Technow et al. (2015) to show how to do prediction of single crosses.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">data</span>(DT_technow)</span>
<span id="cb69-2"><a href="#cb69-2"></a>DT &lt;-<span class="st"> </span>DT_technow</span>
<span id="cb69-3"><a href="#cb69-3"></a>Md &lt;-<span class="st"> </span>Md_technow</span>
<span id="cb69-4"><a href="#cb69-4"></a>Mf &lt;-<span class="st"> </span>Mf_technow</span>
<span id="cb69-5"><a href="#cb69-5"></a>Ad &lt;-<span class="st"> </span>Ad_technow</span>
<span id="cb69-6"><a href="#cb69-6"></a>Af &lt;-<span class="st"> </span>Af_technow</span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="co"># RUN THE PREDICTION MODEL</span></span>
<span id="cb69-8"><a href="#cb69-8"></a>y.trn &lt;-<span class="st"> </span>DT</span>
<span id="cb69-9"><a href="#cb69-9"></a>vv1 &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(DT<span class="op">$</span>GY))</span>
<span id="cb69-10"><a href="#cb69-10"></a>vv2 &lt;-<span class="st"> </span><span class="kw">sample</span>(vv1, <span class="dv">100</span>)</span>
<span id="cb69-11"><a href="#cb69-11"></a>y.trn[vv2,<span class="st">&quot;GY&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb69-12"><a href="#cb69-12"></a>anss2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(GY<span class="op">~</span><span class="dv">1</span>, </span>
<span id="cb69-13"><a href="#cb69-13"></a>               <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(dent,<span class="dt">Gu=</span>Ad) <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(flint,<span class="dt">Gu=</span>Af), </span>
<span id="cb69-14"><a href="#cb69-14"></a>               <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb69-15"><a href="#cb69-15"></a>               <span class="dt">data=</span>y.trn) </span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      104.311   17:15:57      2           0
##     2      143.766   17:15:58      3           0
##     3      152.662   17:15:59      4           0
##     4      153.91   17:16:0      5           0
##     5      153.974   17:16:1      6           0
##     6      153.978   17:16:2      7           0
##     7      153.978   17:16:3      8           0</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">summary</span>(anss2)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                VarComp VarCompSE    Zratio Constraint
## u:dent.GY-GY  16.06423 2.5737578  6.241548   Positive
## u:flint.GY-GY 11.42070 2.1591718  5.289390   Positive
## units.GY-GY   16.81801 0.7689509 21.871368   Positive</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>zu1 &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>dent<span class="dv">-1</span>,y.trn) <span class="op">%*%</span><span class="st"> </span>anss2<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:dent</span><span class="st">`</span><span class="op">$</span>GY</span>
<span id="cb73-2"><a href="#cb73-2"></a>zu2 &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>flint<span class="dv">-1</span>,y.trn) <span class="op">%*%</span><span class="st"> </span>anss2<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:flint</span><span class="st">`</span><span class="op">$</span>GY</span>
<span id="cb73-3"><a href="#cb73-3"></a>u &lt;-<span class="st"> </span>zu1<span class="op">+</span>zu2<span class="op">+</span>anss2<span class="op">$</span>Beta[<span class="dv">1</span>,<span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb73-4"><a href="#cb73-4"></a><span class="kw">cor</span>(u[vv2,], DT<span class="op">$</span>GY[vv2])</span></code></pre></div>
<pre><code>## [1] 0.7756383</code></pre>
<p>In the previous model we only used the GCA effects (GCA1 and GCA2) for practicity, altough it’s been shown that the SCA effect doesn’t actually help that much in increasing prediction accuracy and increase a lot the computation intensity required since the variance covariance matrix for SCA is the kronecker product of the variance covariance matrices for the GCA effects, resulting in a 10578x10578 matrix that increases in a very intensive manner the computation required.</p>
<p>A model without covariance structures would show that the SCA variance component is insignificant compared to the GCA effects. This is why including the third random effect doesn’t increase the prediction accuracy.</p>
</div>
<div id="spatial-modeling-using-the-2-dimensional-spline" class="section level3">
<h3>7) Spatial modeling: using the 2-dimensional spline</h3>
<p>We will use the CPdata to show the use of 2-dimensional splines for accomodating spatial effects in field experiments. In early generation variety trials the availability of seed is low, which makes the use of unreplicated design a neccesity more than anything else. Experimental designs such as augmented designs and partially-replicated (p-rep) designs become every day more common this days.</p>
<p>In order to do a good job modeling the spatial trends happening in the field special covariance structures have been proposed to accomodate such spatial trends (i.e. autoregressive residuals; ar1). Unfortunately, some of these covariance structures make the modeling rather unstable. More recently other research groups have proposed the use of 2-dimensional splines to overcome such issues and have a more robust modeling of the spatial terms (Lee et al. 2013; Rodríguez-Álvarez et al. 2018).</p>
<p>In this example we assume an unreplicated population where row and range information is available which allows us to fit a 2 dimensional spline model.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">data</span>(DT_cpdata)</span>
<span id="cb75-2"><a href="#cb75-2"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb75-3"><a href="#cb75-3"></a>GT &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb75-4"><a href="#cb75-4"></a>MP &lt;-<span class="st"> </span>MP_cpdata</span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="co">### mimic two fields</span></span>
<span id="cb75-6"><a href="#cb75-6"></a>A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT)</span>
<span id="cb75-7"><a href="#cb75-7"></a>mix &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb75-8"><a href="#cb75-8"></a>            <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id, <span class="dt">Gu=</span>A) <span class="op">+</span></span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="st">              </span><span class="kw">vs</span>(Rowf) <span class="op">+</span></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="st">              </span><span class="kw">vs</span>(Colf) <span class="op">+</span></span>
<span id="cb75-11"><a href="#cb75-11"></a><span class="st">              </span><span class="kw">vs</span>(<span class="kw">spl2D</span>(Row,Col)),</span>
<span id="cb75-12"><a href="#cb75-12"></a>            <span class="dt">rcov=</span><span class="op">~</span><span class="kw">vs</span>(units),</span>
<span id="cb75-13"><a href="#cb75-13"></a>            <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -154.198   17:16:4      1           0
##     2      -152.064   17:16:4      1           0
##     3      -151.265   17:16:4      1           0
##     4      -151.202   17:16:4      1           0
##     5      -151.201   17:16:4      1           0</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">summary</span>(mix)</span></code></pre></div>
<pre><code>## ============================================================
##          Multivariate Linear Mixed Model fit by REML         
## **********************  sommer 4.1  ********************** 
## ============================================================
##          logLik      AIC      BIC Method Converge
## Value -151.2011 304.4021 308.2938     NR     TRUE
## ============================================================
## Variance-Covariance components:
##                     VarComp VarCompSE Zratio Constraint
## u:id.Yield-Yield      783.4     319.3 2.4536   Positive
## u:Rowf.Yield-Yield    814.7     390.5 2.0863   Positive
## u:Colf.Yield-Yield    182.2     129.7 1.4053   Positive
## u:Row.Yield-Yield     513.6     694.7 0.7393   Positive
## u:units.Yield-Yield  2922.6     294.1 9.9368   Positive
## ============================================================
## Fixed effects:
##   Trait      Effect Estimate Std.Error t.value
## 1 Yield (Intercept)    132.1     8.791   15.03
## ============================================================
## Groups and observations:
##        Yield
## u:id     363
## u:Rowf    13
## u:Colf    36
## u:Row    168
## ============================================================
## Use the &#39;$&#39; sign to access results and parameters</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># make a plot to observe the spatial effects found by the spl2D()</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>W &lt;-<span class="st"> </span><span class="kw">with</span>(DT,<span class="kw">spl2D</span>(Row,Col)) <span class="co"># 2D spline incidence matrix</span></span>
<span id="cb79-3"><a href="#cb79-3"></a>DT<span class="op">$</span>spatial &lt;-<span class="st"> </span>W<span class="op">%*%</span>mix<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:Row</span><span class="st">`</span><span class="op">$</span>Yield <span class="co"># 2D spline BLUPs</span></span>
<span id="cb79-4"><a href="#cb79-4"></a>lattice<span class="op">::</span><span class="kw">levelplot</span>(spatial<span class="op">~</span>Row<span class="op">*</span>Col, <span class="dt">data=</span>DT) <span class="co"># plot the spatial effect by row and column</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEGWlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VQNcC+8AAClPSURBVHgB7Z0JlBTV1cdvDwzrsA2ryO4ughIEIioQNIoag1E4oIK7CcYkroScYDgKKkjcEjUxuIBbRGWRoyCKooSguLCGzRgBEWUHERiWgemv/s+vZ6anq7tvLd3Vy/+d01D96r7tVzW337v16t5Q2ErCRAIkQAIBECgIoE02SQIkQAKGABUQbwQSIIHACFABBYaeDZMACVAB8R4gARIIjAAVUGDo2TAJkAAVEO8BEiCBwAhQAQWGng2TAAlQAfEeIAESCIwAFVBg6NkwCZAAFRDvARIggcAIUAEFhp4NkwAJUAHxHiABEgiMABVQYOjZMAmQABUQ7wESIIHACFABBYaeDZMACVAB8R4gARIIjAAVUGDo2TAJkAAVEO8BEiCBwAhQAQWGng2TAAlQAfEeIAESCIwAFVBg6NkwCZAAFRDvARIggcAIUAEFhp4NkwAJUAHxHiABEgiMABVQYOjZMAmQABUQ7wESIIHACFABBYaeDZMACVAB8R4gARIIjAAVUGDo2TAJkAAVEO8BEiCBwAhQAQWGng2TAAlQAfEeIAESCIwAFVBg6NkwCZAAFRDvARIggcAIUAEFhp4NkwAJUAHxHiABEgiMABVQYOjZMAmQABWQh3tgzZo1snDhQg81xBZdvny5LF68OPaEhxzUh3r9TBg3xu9nmj9/vnz55Zd+Vilz586VDRs2+FonK/OPABWQB5bvvfeevPjiix5qiC06c+ZMmTJlSuwJDzmoD/X6mTBujN/P9PTTT8uCBQv8rFIee+wx3xW6rx3M88qogPL8BuDwSSBIAlRAQdJn2ySQ5wSogPL8BuDwSSBIAlRAQdJn2ySQ5wSogPL8BuDwSSBIAlRAQdJn2ySQ5wRCYSvlK4OSkhLp3bu3HDhwwBWCHTt2yMGDB6Vly5auytsV2rZtmxw5ckRatGhhd9pV3ubNm6VatWrStGlTV+XtCn377bdSs2ZNady4sd1pV3kbN26UunXrSqNGjVyVtyv01Vdfmfrq169vdzppXrNmzWTOnDlSUJDe32pcsx49eojbfica2Pbt22XEiBFy6623JhJLy7nqaWklQxvZsmWLbNzwjbw96W1VD0OtosV2795tFBBu0sqp7PXK3xIfF1wSfX7nzp2C3wQ//7ChKEOhkBQXF0c35uHb1q1bjQJq0KCBh1qii+KPrk6dOr7+0W3atEnq1asnRUVF0Y0pv3Xu3FlKS0vNWJVFfBH77LPPJHzssdLl0Ud9qa9yJXsspTxt/HgqoMpQgjrGr3inEzupmg+1V4lJ2Wc6OUgV6JrWV5jFkp06+Q/Da501atQIjGj12rWlaQqY7LdmQJgRZ0JK77wyE0bMPpAACWQMASqgjLkU7AgJ5B8BKqD8u+YcMQlkDIG8NkLjKoSspbDWtqO9agXXaiX1cmUz9LIFfXWyG+rp5CDVep1O1glLJ2PStW5dy846ya+V9ry8fUSsw+hZijMgzwhZAQmQgFsCVEBuybEcCZCAZwJUQJ4RsgISyC8C2FeGfWBVEzblOnX+lvc2ICmzMO6pijLOd6XNpOyBOOW9ZJ/opbB92W322ba5bbQ2EwcOIgv62zblKTOsbV85Hk+dycHC+/btk759+8p1110nt9xyS/kIR48ebZy/Yd8UdvHPmjVLmjdvXn4+3gFnQPHIMJ8ESCCKwKJFi6Rnz56yevXqqHx4sYQ3S5yHS11s/sSrHprEGZCGEmVIIAAChVab/r0VVzGAHda7hpsPHxa8SlQ11apVK+5rJ5dffrncdtttMnv27Khi06dPl4EDB0qbNm1M/p133indu3eXiRMnmleAooSrfOEMqAoQfiWBXCewdeVK+eijj6Rt27Yxn0ceeSTu8JctWyY33XRTjFJZt26dtGvXrrwc6t2/f7/AVpQscQaUjBDPk0COEWhhvWB79tlny/vvv+9oZLWtd9PsEl4irvzWfuTF3127dkmTJk3sipTn5b0CKrPmgHuVxmXt+9QFuuWvuQhHfl9+LRIehBKedXeyq4Nie5WydZVyECubqBMOR5scEhYKnZnwNE+mgAA8N+zZU/EkJ3KscVPDJVgKLgirJIF8IgDbD5ZhkYRj+J6Cb6dkiQooGSGeJwESSEhg6NChMnnyZFmxYoXs3btXxo0bJ4MHD05YJnIy75dgERD8nwRIwB0BeG7EvqDTTz/deJ887bTT5KmnnlJVRgWkwkQhEiCBCIHXX491+TlmzBgZOXKkcW/csGHDiGjS//NeAWENqjUua3fZhucl5e5cYKe+SHi7Tnax0viO2rTepJOv+iv1LXY3f6WTPMw2AthDhI+TRBuQE1qUJQES8JVA3s+AfKXJykjARwLYCa1fzOgb1s749TW6l+QMyD07liQBEvBIgArII0AWJwEScE8g75dgRyx2G5T8WjdXCjoQC/kX16+i1S0Vh4mOmjpwSeFfRLFEPeK5fCPAGVC+XXGOlwQyiEBGKiBEBsV27rIyeAuLTTh32HInwEQCJJDdBDJOAb300ktyzDHHSP/+/Y1ntblz55YTnj9/vnTo0EHOOeccE7q4ql+SckEekAAJZAWBjFJAcJAEN49TpkyR5cuXC3yTXHXVVQbkgQMHzHbvsWPHytq1a+WZZ56RIUOGmJ2XWUGanSQBEoghkFFGaCy98FLbj370I9PRo48+WuBT5NChQwJnSHB6PWjQIHNuwIABMmrUKJkzZ45cfPHFMQPTZiBC9g9+3JKXUMeIapa8rnKJFOwGDiuN0NliWK42vpxW0gNtrLFsGXvSAWe5QEYpILxDcu655wocX+NltgkTJsg999wjcHS9fv16472tMm+4Adi4cWPlrJjjd955x5SNOWFlbN++3by9a3eOeSQAAmHLDgl/x4WF2BYYmzp27ChnnkknRLFkdDkZpYAiXd62bZtxfA1FtGXLFjMD2rRpkzRo0CAiYv6HFzbMkBIlOMleunSprcj3338vpaWltueYSQIRAkuWLJFq1TBXjk316tWjAorFos7JSAUE/7L/+Mc/pKSkROBVrU+fPsboDIVROeF7Mq9r8GEbL+Fp2sKF2jgu8Wphfi4TCBUUyBNPPBHXUXsqx17DqjyxQ1N3rStX6O4qd1gqo4zQq1atkscff7x8CHXq1JFTTjnFGKSx3MIyrHKCAmnf3sFuusqFeUwCJBA4gYyaAR111FHGp0i3bt0ETo7w2B0zlIceesg4O6pevbqxC914443ywgsvmL1ACP/hJTnZCd1G+XMUDtrCqXTdUbfCi2ZShCGlnlcb6tGiE2N90h7+IKANdqh9ITOkbJdi7ghklAJq1KiRPPnkk/LLX/7SOLlGWA98hzJCevbZZ81TMDz9Ki4ulkmTJkk8T/3ucLAUCZBAOglklALCwBH8DB8YnZs1axZl/IMtCCFAEJdaE/Y1nSDZFgmQgHMCGaeAIkPAcswuhUIhKh87MMwjgSwkkLEKKF0s8bbZNmVjxUoXpnUdvDWvtpko7ToYSsG1ygE5EasI++SkVELZVPRT6zY39OOEXePJNBHIqKdgaRozmyEBEsgQAlRAGXIh2A0SyEcCVED5eNU5ZhLIEAJUQBlyIdgNEshHAnlvhE7JRXdghNZudAv11/e0bKJONnSSTg5SQRptteNBP1Nh2Ea9QST8cTIqRhDk2SYJkEBeEOASLC8uMwdJAplJgAooM68Le0UCeUGACigvLjMHSQKZSYBGaAfXRfsGtRMnLuqd0A76qRVNiWHZgQFe289UGJYXKRsP8voou5jVYpwBZfXlY+dJILsJUAFl9/Vj70kgqwlwCZbVl4+dJ4H0EUB0miNH4MLvhwTPFLVq1Yp8dfU/Z0CusLEQCeQfAXgfhZvkyKdLly6eIeT9DAgauKkS416lXN3tSkFLTOvqVF9jsLuBUzEeJ2MXpduQbUrXKo7azmFhzH7gsx1+2eEoEAkzIK8p7xWQV4AsTwKpIlDTqlj74+ikD25e71i5cqVRPG3btjWhrOLFSXPSD8hyCeaUGOVJIMsJ/NeKMjxv3jwTbBGKpPJnzJgxtqNDbL0CK0TR2WefLUVFRXLqqafK4sWLbWWdZFIBOaFFWRLIAQLHde5sFMn+/ful6mfkyJG2I0TYdESAnTp1qnz99deCyDW/+MUvTLh02wLKTCogJSiKkUCuEIDtBrMZhLmq+kG+Xbruuuvk5ZdfNssw2IAQMh1h0VesWGEnrs7LexsQAu620eJSGjjDDkJPqmWd7DDWtu+gzq/b6yC1UTJCbWVTdHU6kSoY4ESasloCM2bMEITN6tWrlykCJYZw1QgY6iXZqzsvNbIsCZBAzhFAGPRf/epXJl4fnog9+OCD0rt3b2na1JuZPO9nQDl3p3BAJJACAldccYWJUtypUydjNzr66KPl1Vdf9dwSFZBnhKyABHKfAJZbTzzxhPzlL3+R7777Tpo0UcYpT4KGS7AkgHiaBEigggCM1n4pH9TKGRAiE2oNp8rds2rDstV0gdLXc3gdLpcuqd1saMdtNbtK17TeoK+sD2IFKQi06M1y4aDzFE1IgDOghHh4kgRIIJUEOANKJV3WTQIeCNSwyqZiptbAQ5/8LsoZkN9EWR8JkICaAGdAUMFK246a6k61pJTN0MmGOuvkIKW1F+1Tbi7Ut5waybIH9PWGeutkm/5YJ0ep1BLgDCi1fFk7CZBAAgJUQAng8BQJkEBqCVABpZYvaycBEkhAgAooARyeIgESSC0BGqEd8NUajB1UmXuifhv0HRLSbsLUvsPt3emowwHkmThnQHl2wTlcEsgkAlRAmXQ12BcSyDMCGauA4PYRbiDt0rp16+Tw4cN2p5hHAiSQRQQS2oD27NkjEydOVA/nwgsvlGOPPVYtbyf4/PPPy/33328cZR84cEB+85vfyC233GJE58+fL1dffbU53rFjh7zyyivSr18/u2qYRwJZT6DQGkFxCkZRPwV1uq0yoQKC34/hw4er64aTIi8KqKSkRG6//XaZPXu2nH766bJ27VrpbDnQHjRokDRs2FDgl3bs2LHm+5QpU2TIkCHGL62X6IzhA5ZrUL2O1bFwcNeEtG5RtW5W0UNlnUUO3oZX7xZ3UqeOpsgPYahU0toHBdqd5XEm4aq+UCg5gYQKqHXr1p693ifvQoXEt99+KyNGjDDKB7kdOnQwPmffffddOe6440xfoIyQBgwYIKNGjZI5c+bIxRdfbPLs/oFSKy0ttTslcDNprfNszzGTBH4gEJbdu3dLzZqI0hWbkO/lBzC2xvzKSaiA4qHABVmzZo2x0WCGglCtfiTMnirPuD755BP58ssv5YwzzpDPPvtMEBStcoJDbHjmT5RuvPFGmTlzpq1IWVmZ1A7Vtj3HTBIAgbIjZebHL14U0BtuuMH4RyYtdwQcKSDMJBA36JFHHik3AiOMR48ePWT69OnSvLly7q/o6//+9z+57LLLzJLrmGOOkTfeeEMaNIh2JFC/fn3ZtWtXwtpeeumluOdhzP5Jz75xz/MECRRYrki3bt0adwZEQt4IOHoKhlhA8AsLB9WvvfaaLFmyRPAHvm/fPvnJT37i23Lt448/NkHQ7rzzTmMTwhAbN278w5Kp0nixhGrZsmWlHB6SAAlkEwH1DAiPxOGQGkoBiiiSTjvtNBMl8fjjjzde8xGqw0uaO3euDBw40LQFI3MkYbm1fv36yFfzP2Yw7dt78ykRquW/y8/wwqhuJv6inTQ6MUJrZR34FU+FY6yUPOJJTLv8bHh5+SEPAiSgngHBQLx371655pprYrqLJRJiRmPm4iVt2rTJhHtFzCE8Xt++fbv5IHzsWWedZaI4Tpgwwdie8Lgee4G6d+/upUmWJQESCJCAWgEhHCs84r/55psx3cUaGcoHj+G9JCzvsKzC43YEPIt8nnzySROF8dlnn5U//elPctRRR8m4ceNk0qRJUrs2jchemLMsCQRJQL0EKywsNLYf7MPB43nYfPDH//nnn8sf//hHKSoqkvPOO8/TWO69917BJ17q06ePbN682RgF/TR4x2uP+SRAAqkloFZA6Aaefl1//fVmmYTveDQJ2xAUEnYlew3TijqTJbRJ5ZOMEs+TQHYQcKSAiouLzeP2pUuXysqVK02EROzdgf3Hr71AmYxNu2M61Ec/ipDSEOwk1pjWJYXWdzRG0zQFbjbUMdEcGPXVnLR+uwPcp1rdet3R0W515W1Xu0QpmAYxtQ0I74Th/SskPPm68sorBftwpk2blnQzYBrGwSZIgASykEBSBfTNN9/IBRdcYAzDy5YtixriV199JXgq1a1bN3n//fejzvELCZAACSQjkFQB4e1zKB7MdPr27RtV31133SXz5s2Tdu3aydChQwVvrzORAAmQgJZAQgWEjX/vvfee3HfffeWG56oV9+rVyxinMVOK985V1TL8TgIkQAIgkNAIjfexkODnJ1HC7mc8mfrvf/+bSCwjz4Utg5w68J3SLYTWsJwqIGqXFNpd2FZHi71tOLcfqtJ1R6ijfXEvuWGtEdpLIyyblEDCGVDkNYdt27YlrAgvpOLNcrwuwUQCJEACWgIJFRBescDu5lmzZiWsb9GiRQIlhY2CTCRAArlL4ODBg7JhwwbfBphQAaGVSy+91Lz2AHcbdmn58uXm5dETTjjB86sYdvUzjwRIIDMIjB49Wlq1amX8c3Xt2lW2bNG+9Ry//wltQCj28MMPm/0/UER4QbRLly7mqRcM1KtWrRJ4K8RM6fXXX4/fCs94JqDeYOe5JfsK1BviHGxY3GvfVEyuE3NNa61da3VMM8xIQGDBggXy9NNPC1Y7eC902LBhxnsp3sf0kpIqILyA+sILL8jJJ58sb7/9tjz66KOCt9Pxbhjy4BEOT8nq1q3rpR8sSwIkkMEEsAKCm5yInRdueeCJAhuU43mL1AwnqQJCJTAywxMiPnCBAWfxcI8az0+upmHKkAAJJCYQPmS5LN+eWMbN2RWfrpAPP/zQ1pnfHXfcIfhUTfC9VdnGi79/TETwdkSTJsr3iapWan1XKaDK5TAjgvMxJhIggewkcHyHEwQ2nKlTp8YMoF49+zU0vFDg1atIgvcLJLhETqsCinSA/5MACWQngcLqhWb1Ar9a2gSXyIgTGEmRY68ukR3PgCIdyJn/8RxQucFQO+a99j8itsV/+B2xPRWVqY4fZpXSGqy1clEdSfZFawS26tmp3NyYeBdadIe0GybrfBBdjt8SE4DtB8uwSMIx3O94tf0mfQwfaZD/kwAJ5C8BvOs5efJkWbFihXHNDI+kgwcP9gyEMyDPCFkBCeQ+AYTegqtkRCxu1KiRccnz1FNPeR44Z0CeEbICEsgPAmPGjDFOCFevXi1vvfWWccPsdeScAXklyPIkkEcEEIbaz1DUVEAh6+4pzqM7yOVQtQZr4FSnFBihtfHL/Akmrh4pBeMQ4BIsDhhmkwAJpJ4AZ0CpZ8wWSMAdgYNWMe/ve8a2vSs2K6gczoCCIs92SYAEhAqINwEJkEBgBLgEs1SwepexcpevE/cR2p3Qomzb3EnaabuTjipv0VSE0eqnbBtii5Syba7VCYaG6eQo5Y4AZ0DuuLEUCZCADwSogHyAyCpIgATcEaACcseNpUiABHwgQAXkA0RWQQIk4I4AjdBQwUoDrzbel5PgRFqjaVcHTudC/XU3Q9lEnZyR2qqUdbCrXCs6Wdk0xI5zIEvR4AlwBhT8NWAPSCBvCVAB5e2l58BJIHgCXIIFfw3YAxKwJ2C9iqF9Cdi+AvvcMF/FsAfDXBIggfwikPczoFA1aye00i2ENpDe5ym4h5z4ma670P8OhHfo6nTijkO7C7yhrmkjpXXHUTZDV2k4FVu7dU3nhRRtQHlxmTlIEshMAhmrgMrKyuTzz+3nEvDIjwCJTCRAAtlNIGMVEKKwXn/99VF058+fLx06dJBzzjlHEKdo9uzZUef5hQRIILsIZJwNCJEWERr2xRdfNLGnIzgPHDhgvPKPHTtWBg0aJFOmTJEhQ4bIxo0bPfmoDR+xnjRUhDuKNGf7f5FyM2BTB3HBnMS8su2UXaZyY6UTZ1ehxnYNxeapPQtYRTfEFveco93cWKDcrBlyYtTy3Pv8qyDjZkCY+YQty9+jjz4adTWWLVsmBw8eNMoHJwYMGCDNmjWTOXPmRMnxCwmQQPYQyLgZ0EMPPSS1a9eWl156KYri+vXrpW3btlF5iNaIGVCiNHr0aPnoo49sRUpKSuSgNbNiIoF4BEpLS+XnP/+5FBTY/1ZffPHF8utf/zpeceYnIZBxCgjKxy5t2rRJGjRoEHWqfv36giVbooQbpHv37rYimzdvlj+NHGV7jpkkAALVqlWTm2++WWrUqGELBD+CTO4JZJwCijcUGJ2///77qNP43rJly6i8ql+6dOlSNav8O56m4QZjIoF4BDDzOf/886VmzZrxRJjvgUDWKCD80mAZVjlBgbRvr9xFWLlgpWMnGxG1xupiB0boSl3x7VD71r7WCwA6Fl6j7J7WAG5VpzXAazcXoodFe3T9LJuikwuX6eRSIlVq1ZoCt7kS/Tuekq5rK7Vf2GpLp1HurLPOkurVq8uECROMkfr55583e4HiLa/S2DU2RQIk4JJA1syAsFR69tlnzVOwUaNGSXFxsUyaNMkYrF2OncVIgAQCJpCxCujKK68UfCqnPn36CAzHW7dulebNHcz1K1fCYxIggYwhkDVLsAixkLUzjMonQoP/k0B2E8jYGVC6sIYtnyvaN6PVu3wd2MW1O3ed8NC+OV/UUV+r1i/NPgdj76pvXi0Z3q4WpWAGEMi6GVAGMGMXSIAEfCKQ9zMgnziyGhLIOwJHjhyRQ4cORY27Vq1aAjOJNnEGpCVFORIggSgC48aNkzp16kR9Vq5cGSWT7AsVUDJCPE8CJGBLYOnSpfLwww8L3qmMfDp2dGBYtGrlEsxyxyHKXb5a75za3bi4qlqDsZMNseodxg52bLfujN4mT076+Wby6ozEYKWcEdviRJiyXggsWbJEbr/9drNBuLCw0FVVVECusLEQCaSBAMwr2oCQDrqz5os18umnn8qpp54aU+qmm26SYcOGxeRXzdizZ4+sXbtWsAyDo0DYfcaMGePYMwAVUFWy/E4COU6gbcO2ctJJJ8kzzzwTM1LtHrstW7YINgYPHz5cXnvtNZk6darZOIwlWO/evWPqjZdBBRSPDPNJIEcJ1C6sLUVFRdK5s3JdbXHAbOm7774zROD/aMSIETJ37txyQpdffrn87W9/k7feeosKqJwKD0iABHwhAOUSCQQBzxRr1qyRf//733LDDTdE1Q+f7U4SZ0CWu4VUxLzSXgRtbCytHNpdpWzcyU7kvcodzk7cc32o7OcGpRzEWjuQpaiewJlnnhklvGPHDrntttvMUg7nPvjgA/n4449l+vTpUXLJvlABJSPE8yRAAjEE4CAQsyIsx+AYcPfu3fLcc89JkybKyA3/XyMVUAxaZpAACWgIDB06VPCBd4qmTZs62gEdqZ8KKEKC/5MACbgigOg0bhN3Qrslx3IkQAKeCXAG5AShk22+TupVyC5SyERE+kUOkvz/eJLzlU+fUflLguMvEpyrekq7w9mJEbpqG3G/a/2g6N+rjNsUT8QnwBlQfDY8QwIkkGICnAGlGDCrJwHXBKxXMbRbRJy0EWZUDCe4KEsCJJCrBDgDwivuytfHC8b7fxto7RtONg3e6383RWvbceIRVWuD+o2D8Wg9FjiokqIpJEAbUArhsmoSIIHEBKiAEvPhWRIggRQSoAJKIVxWTQIkkJgAFVBiPjxLAiSQQgI0QmOjWVMdYW38sIL+uvqcSM12IqyU3aWUS5XYD95lktfuZBNm1x8nrw8S4Rk6OUqllgBnQKnly9pJgAQSEKACSgCHp0iABFJLgAootXxZOwmQQAICtAElgMNTJBAoAUTFUG6SddRPrfHNUaXuhKmArDlgqLE7ePFK7Y13IovztW+up2IXthNs4YVKaa1nA26tVgJ1J8YlmDtuLEUCJOADASogHyCyChIgAXcEqIDccWMpEiABHwhQAfkAkVWQAAm4I5D3RuhQHZGCEe7gZXupRg4GMFkp21Ap50TMiSuScHNlzVuUcnTJqgTlTowzIHfcWIoESMAHAlRAPkBkFSRAAu4IUAG548ZSJEACPhDIaxtQnTp1ZP369dKtWzdXKHfu3CmHDh2SFi1aRJW3ws2r05EqkqhPwmGpUbNm1BlsitWmg1UEDx48aKJW1qhRo8oZ/dfCKqIHDxyQgoICKaxSZ9XxVCmW8OsBq87q1apJ9cLo1p5LWCr6ZLg0+vuB/ftNfdWrV7nVq0KKLlb+rbT0kFSz+pTu1Lx5c5m1cab0eMPdvZmov/sO75O2P26TSCRt50JhK6WttQxsaN26dbJ9uxNPxhWDeO211wTlf//731dkejyaNGmS7Nu3T26++WaPNVUUf+KJJ6Ru3bpyzTXXVGR6PBo/fry0b99eBg4c6LGmiuJ33323+TG46KKLKjI9Hg0fPlxQX58+fVzV1LJlSzn66KNdlfVaaNWqVeZe8FqPXfmTTjpJioqK7E6lNa/Kz0Ja286IxvBHhI+b9Mknn0hJSYnrGZRdm++++67s2bPH1zrxR1SvXj1f68QvdNu2bX2ts0mTJtKhQwdf62zUqJEcd9xxvtZpd91SkXfyySenotqMqpM2oIy6HOwMCeQXASqg/LreHC0JZBQBKqCMuhzsDAnkFwEqoPy63hwtCWQUASqgjLoc7AwJ5BeBvH8K5uVyH3XUUWYfkJc6qpZt1aqV7Lf2rviZ2rVrJ7Vr1/azSjnmmGME4/czHX/88dKsWTM/qxQ8bm7c2GePc772ML8ry/t9QPl9+Tl6EgiWAJdgwfJn6ySQ1wSogPL68nPwJBAsASqgYPmzdRLIawJUQHl9+Tl4EgiWABVQsPzZOgnkNQEqIA+Xf8eOHeZlVA9V2BbdvXu3bN682facm0y87Y+++plQJ9x8eE3o19atW2OqQd0bNmyIyddkxKuztLTUV66avlAmMQEqoMR8bM+uWbNGzjnnHOnRo4eceOKJMmTIEN/cJhw5ckQuuOACgWsKrwlv1V9yySXSpUsX84FbCq9KA8oC/evZs6cZ+2233ea6m3A70rdvX3n55Zej6hg9erRgP9QZZ5whXbt2lS1btA6cxVyHqnXC48yNN95o3rSHW45evXrJwoXaCIZRXeMXnwlQAbkAev/990v37t3liy++MJ+NGzfKCy+84KKm2CL33XefLF++PPaEi5w///nPZob21VdfyZdffimYATzzzDMuaqoo8uSTT0rDhg3l888/lxUrVsjkyZPl448/rhBQHi1atMgosdWrV0eVWLBggTz99NOC8+hzp06dZMQIXdSAeHW++eabpo9oCz8eUMojR46MapdfgiFABeSQO35NsWMXDsNCoZDUtDwX4lf1rbfeclhTrDj+kKdMmSI33HBD7EkXOVAWUGjGc6HlZfCVV16RQYMGuaiposh//vMf4z8JY4eTszZt2siSJUsqBJRHl19+uQwbNszMpioXmT59unFyhnpr1aold955p7z66quWk8jkfvPi1VlWVibjxo0rd8B1/vnny/vvvy/wwMgULAG+iuGQP/7w7rrrrvJScKH6z3/+0/wxlWe6OMBy5NprrzUzKSghr38c33//vWzbtk2+/vpr+e1vf2vsLFdeeaXnpR08DMKzIsYNOxXclQ4YMMDxiJctW2ZeD3n77bejysLDJBR6JMHpGV5NgV0HDssSpXh19u/fP6oYvE5i+QwFxxQsAc6APPDHH+EVV1xhfEL/7ne/81CTyK233mrqgs3Dj7Rp0yYz83nooYfkwQcflMcee0yef/55mTVrlqfq9+7da2YjMBCvXbvWzILc2JXivZsGpVa/fv3yPkbchu7atas8L95BvDoryz/33HNmGfrUU09VzuZxQASogFyCxwyjX79+gj/I2bNnS4zTcwf1zpw5UzAT6N27t3z00UfyzTffGMPr0qVLHdQSLYo/Yiw9YD8566yzjF9kGGKhhLykq6++WkaNGmWWRR9++KExFleeEXqpG2Xx4iiM55EUOYZbWa8Jy7A//OEPMnfuXDnllFO8VsfyPhDgEswFRCwHYEc44YQTZOLEieIl2gSaxzIJy4tbbrnF9Obbb78VPA2D/QaO790k+GyGfapyxA74R8ayzG3CEzAY3M8999zyKvDE6YEHHij/7vUAth8swyIJx02bNjUzrUiem/8ROGDatGkyf/58OfbYY91UwTIpIMAZkAuoQ4cONcbXRx55RDATwp6Y7777zkVNPxSBMXbx4sXlH9iCLrvsMtfKB7XC8IzZCpZgMOCif5j9QHG6TXCVAQfveEqFhNkJljRnnnmm2ypjyoEtnqzhCRtml5i1DB48OEbOSQZsPnhKOWPGDPMED9cLH8wQmYIlQAXkkD8MnXjihac1mGXg1xmfCy+80GFNqRcfO3as+SNGWBn86uPpndcQQpiRvfjii2ZPDfwBwe7i5wwIxuHrrrtOTj/9dKPsoDix7cFLAgfYlrDsilwv/I+ZJlOwBOgPKFj+aWkdO6tho8Jjc78SNgdC+VQ2GPtVN+rBU0B8sOeIKXcJUAHl7rXlyEgg4wlwCZbxl4gdJIHcJUAFlLvXliMjgYwnQAWU8ZeIHSSB3CVABZS715YjI4GMJ0AFlPGXiB0kgdwlQAWUu9eWIyOBjCdABZTxl4gdJIHcJUAFlLvXliMjgYwnQAWU8ZeIHSSB3CVABZS715YjI4GMJ0AFlPGXiB0kgdwlQAWUu9eWIyOBjCdABZTxl4gdJIHcJUAFlIPXFtEw4Dy/8gcOylq3bm3cvlZ1BJ+DCDikLCFAl6xZcqHcdBOeBSORJODi9dNPPzW+nH/2s5/Je++9ZwL0uamXZUjALwJUQH6RzMB64Iwe3hAj6bzzzpOrrrrKxPWaOnUqFVAEDP8PjACXYIGhD6ZhLMOqRp6Ad0P4oYaygqtSxNFCyB0k/A/3qJWjnyLSaNW8N954Q84++2w5fPhwMANjq1lJgAooKy+b+07/9a9/NUEKEUUUCeGaEeUCoWrGjBkjjz/+uAkLhPhkiC3Wvn17EwmjcuRXKBuEQZ4zZ055RxBMsV69ep7CE5VXxoO8IcAlWA5f6ksvvdSE5sEQETwQsxlEg7jooosE4XSQJkyYIKtWrTIfhBlCgoN9KJ577rlHYNC+4IILTCjju+++25xHWON27drJv/71L/Md/0AZMd56OQ4eKAlwBqQElY1iCObXqlUrMzNBkEOEIsZMB0sohFRG+uSTT6Rbt24mxllkjJjJXHLJJYLAg0hQSAsXLpSSkhIzO/riiy/k9ttvN0EUseRavny5mS1BsTGRgBMCVEBOaGWZLJZTiFuPyKsIyIfwxgjTjDhhkYRZEZRU1QR7EIIQIv30pz81MbQWLFggH3zwgZx44okycOBAE/JnyZIlJqprx44dzayoaj38TgKJCFABJaKTQ+e6d+8u48ePN7HhEXE1kmCQtou7vnPnThP7C3IIjdOzZ0+zDIMC6tOnj4m4CkUExfbOO+8IHu0zkYBTAlRATollsfxNN91kopiOHj3a2HwwlJNPPtlEZEWE10jCDGnevHnSqVOnSJaxA2H5BoWDGPZIUEQwTiOPy69yVDxwQsC62ZhyjMDf//53rLHC1hIqZmRWyONwYWFhuFevXmErNHHYetIVLioqCluhoMNWpNCwFYk0PHz48LBlLwpbSqi8vBURNmzZjcLW7mpTBideeeUV044Vcz5s2YLKZXlAAloCnAE50dY5IAtbzR133GGeYCGue4sWLWT27NmycuVKgdG6uLjYLNOmTZsWtVGxc+fOglDMCO+MMkiYASH169ev3KhtMvgPCSgJMDKqElQ+iG3bts0ME5sRmUggHQSogNJBmW2QAAnYEuASzBYLM0mABNJBgAooHZTZBgmQgC0BKiBbLMwkARJIBwEqoHRQZhskQAK2BKiAbLEwkwRIIB0EqIDSQZltkAAJ2BKgArLFwkwSIIF0EKACSgdltkECJGBLgArIFgszSYAE0kGACigdlNkGCZCALQEqIFsszCQBEkgHASqgdFBmGyRAArYEqIBssTCTBEggHQSogNJBmW2QAAnYEvg/C3Gv/0jslUgAAAAASUVORK5CYII=" /><!-- --></p>
<p>Notice that the job is done by the <code>spl2D()</code> function that takes the Row and Col information to fit a spatial kernel.</p>
</div>
<div id="multivariate-genetic-models-and-genetic-correlations" class="section level3">
<h3>8) Multivariate genetic models and genetic correlations</h3>
<p>Sometimes is important to estimate genetic variance-covariance among traits, multi-reponse models are very useful for such task. Let see an example with 3 traits (color, Yield, and Firmness) and a single random effect (genotype; id) although multiple effects can be modeled as well. We need to use a variance covariance structure for the random effect to be able to obtain the genetic covariance among traits.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">data</span>(DT_cpdata)</span>
<span id="cb80-2"><a href="#cb80-2"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb80-3"><a href="#cb80-3"></a>GT &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb80-4"><a href="#cb80-4"></a>MP &lt;-<span class="st"> </span>MP_cpdata</span>
<span id="cb80-5"><a href="#cb80-5"></a>A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT)</span>
<span id="cb80-6"><a href="#cb80-6"></a>ans.m &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(Yield,color)<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb80-7"><a href="#cb80-7"></a>               <span class="dt">random=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(id, <span class="dt">Gu=</span>A, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>))</span>
<span id="cb80-8"><a href="#cb80-8"></a>               <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(Rowf,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>))</span>
<span id="cb80-9"><a href="#cb80-9"></a>               <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(Colf,<span class="dt">Gtc=</span><span class="kw">diag</span>(<span class="dv">2</span>)),</span>
<span id="cb80-10"><a href="#cb80-10"></a>               <span class="dt">rcov=</span><span class="op">~</span><span class="st"> </span><span class="kw">vs</span>(units, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">2</span>)),</span>
<span id="cb80-11"><a href="#cb80-11"></a>               <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -375.872   17:16:6      1           0
##     2      -291.932   17:16:6      1           0
##     3      -258.273   17:16:7      2           0
##     4      -253.459   17:16:8      3           0
##     5      -253.291   17:16:9      4           0
##     6      -253.278   17:16:10      5           0
##     7      -253.277   17:16:10      5           0
##     8      -253.277   17:16:11      6           0</code></pre>
<p>Now you can extract the BLUPs using the ‘randef’ function or simple accesing with the ‘$’ sign and pick ‘u.hat’. Also, genetic correlations and heritabilities can be calculated easily.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">cov2cor</span>(ans.m<span class="op">$</span>sigma<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##           Yield     color
## Yield 1.0000000 0.1234441
## color 0.1234441 1.0000000</code></pre>
</div>
</div>
<div id="section-3-special-topics-in-quantitative-genetics" class="section level2">
<h2>SECTION 3: Special topics in Quantitative genetics</h2>
<div id="partitioned-model" class="section level3">
<h3>1) Partitioned model</h3>
<p>The partitioned model was popularized by () to show that marker effects can be obtained fitting a GBLUP model to reduce the computational burden and then recover them by creating some special matrices MM’ for GBLUP and M’(M’M)- to recover marker effects. Here we show a very easy example using the DT_cpdata:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">library</span>(sommer)</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="kw">data</span>(<span class="st">&quot;DT_cpdata&quot;</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb84-4"><a href="#cb84-4"></a>M &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb84-5"><a href="#cb84-5"></a></span>
<span id="cb84-6"><a href="#cb84-6"></a><span class="co">################</span></span>
<span id="cb84-7"><a href="#cb84-7"></a><span class="co"># MARKER MODEL</span></span>
<span id="cb84-8"><a href="#cb84-8"></a><span class="co">################</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>mix.marker &lt;-<span class="st"> </span><span class="kw">mmer</span>(color<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb84-10"><a href="#cb84-10"></a>                   <span class="dt">random=</span><span class="op">~</span>Rowf<span class="op">+</span><span class="kw">vs</span>(M),</span>
<span id="cb84-11"><a href="#cb84-11"></a>                   <span class="dt">rcov=</span><span class="op">~</span>units,<span class="dt">data=</span>DT,</span>
<span id="cb84-12"><a href="#cb84-12"></a>                   <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb84-13"><a href="#cb84-13"></a></span>
<span id="cb84-14"><a href="#cb84-14"></a></span>
<span id="cb84-15"><a href="#cb84-15"></a>me.marker &lt;-<span class="st"> </span>mix.marker<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:M</span><span class="st">`</span><span class="op">$</span>color</span>
<span id="cb84-16"><a href="#cb84-16"></a></span>
<span id="cb84-17"><a href="#cb84-17"></a><span class="co">################</span></span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="co"># PARTITIONED GBLUP MODEL</span></span>
<span id="cb84-19"><a href="#cb84-19"></a><span class="co">################</span></span>
<span id="cb84-20"><a href="#cb84-20"></a></span>
<span id="cb84-21"><a href="#cb84-21"></a>MMT&lt;-M<span class="op">%*%</span><span class="kw">t</span>(M) <span class="co">## additive relationship matrix </span></span>
<span id="cb84-22"><a href="#cb84-22"></a>MMTinv&lt;-<span class="kw">solve</span>(MMT) <span class="co">## inverse</span></span>
<span id="cb84-23"><a href="#cb84-23"></a>MTMMTinv&lt;-<span class="kw">t</span>(M)<span class="op">%*%</span>MMTinv <span class="co"># M&#39; %*% (M&#39;M)-</span></span>
<span id="cb84-24"><a href="#cb84-24"></a></span>
<span id="cb84-25"><a href="#cb84-25"></a>mix.part &lt;-<span class="st"> </span><span class="kw">mmer</span>(color<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb84-26"><a href="#cb84-26"></a>                 <span class="dt">random=</span><span class="op">~</span>Rowf<span class="op">+</span><span class="kw">vs</span>(id, <span class="dt">Gu=</span>MMT),</span>
<span id="cb84-27"><a href="#cb84-27"></a>                 <span class="dt">rcov=</span><span class="op">~</span>units,<span class="dt">data=</span>DT,</span>
<span id="cb84-28"><a href="#cb84-28"></a>                 <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb84-29"><a href="#cb84-29"></a></span>
<span id="cb84-30"><a href="#cb84-30"></a><span class="co">#convert BLUPs to marker effects me=M&#39;(M&#39;M)- u</span></span>
<span id="cb84-31"><a href="#cb84-31"></a>me.part&lt;-MTMMTinv<span class="op">%*%</span><span class="kw">matrix</span>(mix.part<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>color,<span class="dt">ncol=</span><span class="dv">1</span>)</span>
<span id="cb84-32"><a href="#cb84-32"></a></span>
<span id="cb84-33"><a href="#cb84-33"></a><span class="co"># compare marker effects between both models</span></span>
<span id="cb84-34"><a href="#cb84-34"></a><span class="kw">plot</span>(me.marker,me.part)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen this two models are equivalent with the exception that the partitioned model is more computationally efficient.</p>
</div>
<div id="udu-decomposition" class="section level3">
<h3>2) UDU’ decomposition</h3>
<p>Lee and Van der Warf (2015) proposed a decomposition of the relationship matrix A=UDU’ together with a transformation of the response and fixed effects Uy = Ux + UZ + e, to fit a model where the phenotypic variance matrix V is a diagonal because the relationship matrix is the diagonal matrix D from the decomposition that can be inverted easily and make multitrait models more feasible.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">data</span>(<span class="st">&quot;DT_wheat&quot;</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="kw">rownames</span>(GT_wheat) &lt;-<span class="st"> </span><span class="kw">rownames</span>(DT_wheat)</span>
<span id="cb85-3"><a href="#cb85-3"></a>G &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT_wheat)</span>
<span id="cb85-4"><a href="#cb85-4"></a>Y &lt;-<span class="st"> </span><span class="kw">data.frame</span>(DT_wheat)</span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="co"># make the decomposition</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>UD&lt;-<span class="kw">eigen</span>(G) <span class="co"># get the decomposition: G = UDU&#39;</span></span>
<span id="cb85-8"><a href="#cb85-8"></a>U&lt;-UD<span class="op">$</span>vectors</span>
<span id="cb85-9"><a href="#cb85-9"></a>D&lt;-<span class="kw">diag</span>(UD<span class="op">$</span>values)<span class="co"># This will be our new &#39;relationship-matrix&#39;</span></span>
<span id="cb85-10"><a href="#cb85-10"></a><span class="kw">rownames</span>(D) &lt;-<span class="st"> </span><span class="kw">colnames</span>(D) &lt;-<span class="st"> </span><span class="kw">rownames</span>(G)</span>
<span id="cb85-11"><a href="#cb85-11"></a>X&lt;-<span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>Y) <span class="co"># here: only one fixed effect (intercept)</span></span>
<span id="cb85-12"><a href="#cb85-12"></a>UX&lt;-<span class="kw">t</span>(U)<span class="op">%*%</span>X <span class="co"># premultiply X and y by U&#39; </span></span>
<span id="cb85-13"><a href="#cb85-13"></a>UY &lt;-<span class="st"> </span><span class="kw">t</span>(U) <span class="op">%*%</span><span class="st"> </span><span class="kw">as.matrix</span>(Y) <span class="co"># multivariate</span></span>
<span id="cb85-14"><a href="#cb85-14"></a></span>
<span id="cb85-15"><a href="#cb85-15"></a><span class="co"># dataset for decomposed model</span></span>
<span id="cb85-16"><a href="#cb85-16"></a>DTd&lt;-<span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">rownames</span>(G) ,UY, <span class="dt">UX =</span>UX[,<span class="dv">1</span>])</span>
<span id="cb85-17"><a href="#cb85-17"></a>DTd<span class="op">$</span>id&lt;-<span class="kw">as.character</span>(DTd<span class="op">$</span>id)</span>
<span id="cb85-18"><a href="#cb85-18"></a></span>
<span id="cb85-19"><a href="#cb85-19"></a>modeld &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(X1,X2) <span class="op">~</span><span class="st"> </span>UX <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb85-20"><a href="#cb85-20"></a>              <span class="dt">random =</span> <span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>D), </span>
<span id="cb85-21"><a href="#cb85-21"></a>              <span class="dt">rcov =</span> <span class="op">~</span><span class="kw">vs</span>(units),</span>
<span id="cb85-22"><a href="#cb85-22"></a>              <span class="dt">data=</span>DTd, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb85-23"><a href="#cb85-23"></a></span>
<span id="cb85-24"><a href="#cb85-24"></a><span class="co"># dataset for normal model</span></span>
<span id="cb85-25"><a href="#cb85-25"></a>DTn&lt;-<span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="kw">rownames</span>(G) , DT_wheat)</span>
<span id="cb85-26"><a href="#cb85-26"></a>DTn<span class="op">$</span>id&lt;-<span class="kw">as.character</span>(DTn<span class="op">$</span>id)</span>
<span id="cb85-27"><a href="#cb85-27"></a></span>
<span id="cb85-28"><a href="#cb85-28"></a>modeln &lt;-<span class="st"> </span><span class="kw">mmer</span>(<span class="kw">cbind</span>(X1,X2) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb85-29"><a href="#cb85-29"></a>              <span class="dt">random =</span> <span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>G), </span>
<span id="cb85-30"><a href="#cb85-30"></a>              <span class="dt">rcov =</span> <span class="op">~</span><span class="kw">vs</span>(units),</span>
<span id="cb85-31"><a href="#cb85-31"></a>              <span class="dt">data=</span>DTn, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb85-32"><a href="#cb85-32"></a></span>
<span id="cb85-33"><a href="#cb85-33"></a><span class="co">## compare regular and transformed blups</span></span>
<span id="cb85-34"><a href="#cb85-34"></a><span class="kw">plot</span>(<span class="dt">x=</span>(<span class="kw">solve</span>(<span class="kw">t</span>(U)))<span class="op">%*%</span>modeld<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X2[<span class="kw">colnames</span>(D)], </span>
<span id="cb85-35"><a href="#cb85-35"></a>     <span class="dt">y=</span>modeln<span class="op">$</span>U<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span><span class="op">$</span>X2[<span class="kw">colnames</span>(D)], <span class="dt">xlab=</span><span class="st">&quot;UDU blup&quot;</span>,</span>
<span id="cb85-36"><a href="#cb85-36"></a>     <span class="dt">ylab=</span><span class="st">&quot;blup&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen the two models are equivalent. Despite that sommer doesnt take a great advantage of this trick because it was built for dense matrices using the Armadillo library other software may be better using this trick.</p>
</div>
<div id="mating-designs" class="section level3">
<h3>3) Mating designs</h3>
<p>Estimating variance components has been a topic of interest for the breeding community for a long time. Here we show how to calculate additive and dominance variance using the North Carolina Design I (Nested design) and North Carolina Design II (Factorial design) using the classical Expected Mean Squares method and the REML methods from sommer and how these two are equivalent.</p>
<div id="north-carolina-design-i-nested-design" class="section level4">
<h4>North Carolina Design I (Nested design)</h4>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">data</span>(DT_expdesigns)</span>
<span id="cb86-2"><a href="#cb86-2"></a>DT &lt;-<span class="st"> </span>DT_expdesigns<span class="op">$</span>car1</span>
<span id="cb86-3"><a href="#cb86-3"></a>DT &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield<span class="op">~</span>set<span class="op">+</span>male<span class="op">+</span>female<span class="op">+</span>rep, <span class="dt">data=</span>DT, <span class="dt">FUN =</span> mean)</span>
<span id="cb86-4"><a href="#cb86-4"></a>DT<span class="op">$</span>setf &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>set)</span>
<span id="cb86-5"><a href="#cb86-5"></a>DT<span class="op">$</span>repf &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>rep)</span>
<span id="cb86-6"><a href="#cb86-6"></a>DT<span class="op">$</span>malef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>male)</span>
<span id="cb86-7"><a href="#cb86-7"></a>DT<span class="op">$</span>femalef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>female)</span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="kw">levelplot</span>(yield<span class="op">~</span>male<span class="op">*</span>female<span class="op">|</span>set, <span class="dt">data=</span>DT, <span class="dt">main=</span><span class="st">&quot;NC design I&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">##############################</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="co">## Expected Mean Square method</span></span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="co">##############################</span></span>
<span id="cb87-4"><a href="#cb87-4"></a>mix1 &lt;-<span class="st"> </span><span class="kw">lm</span>(yield<span class="op">~</span><span class="st"> </span>setf <span class="op">+</span><span class="st"> </span>setf<span class="op">:</span>repf <span class="op">+</span><span class="st"> </span>femalef<span class="op">:</span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>malef<span class="op">:</span>setf, <span class="dt">data=</span>DT)</span>
<span id="cb87-5"><a href="#cb87-5"></a>MS &lt;-<span class="st"> </span><span class="kw">anova</span>(mix1); MS</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## setf                1 0.1780 0.17796  1.6646 0.226012    
## setf:repf           2 0.9965 0.49824  4.6605 0.037141 *  
## setf:malef          4 7.3904 1.84759 17.2822 0.000173 ***
## setf:femalef:malef  6 1.6083 0.26806  2.5074 0.095575 .  
## Residuals          10 1.0691 0.10691                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>ms1 &lt;-<span class="st"> </span>MS[<span class="st">&quot;setf:malef&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb89-2"><a href="#cb89-2"></a>ms2 &lt;-<span class="st"> </span>MS[<span class="st">&quot;setf:femalef:malef&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb89-3"><a href="#cb89-3"></a>mse &lt;-<span class="st"> </span>MS[<span class="st">&quot;Residuals&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb89-4"><a href="#cb89-4"></a>nrep=<span class="dv">2</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>nfem=<span class="dv">2</span></span>
<span id="cb89-6"><a href="#cb89-6"></a>Vfm &lt;-<span class="st"> </span>(ms2<span class="op">-</span>mse)<span class="op">/</span>nrep</span>
<span id="cb89-7"><a href="#cb89-7"></a>Vm &lt;-<span class="st"> </span>(ms1<span class="op">-</span>ms2)<span class="op">/</span>(nrep<span class="op">*</span>nfem)</span>
<span id="cb89-8"><a href="#cb89-8"></a></span>
<span id="cb89-9"><a href="#cb89-9"></a><span class="co">## Calculate Va and Vd</span></span>
<span id="cb89-10"><a href="#cb89-10"></a>Va=<span class="dv">4</span><span class="op">*</span>Vm <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb89-11"><a href="#cb89-11"></a>Vd=<span class="dv">4</span><span class="op">*</span>(Vfm<span class="op">-</span>Vm) <span class="co"># assuming no inbreeding(4/(1+F)^2)</span></span>
<span id="cb89-12"><a href="#cb89-12"></a>Vg=<span class="kw">c</span>(Va,Vd); <span class="kw">names</span>(Vg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Va&quot;</span>,<span class="st">&quot;Vd&quot;</span>); Vg</span></code></pre></div>
<pre><code>##        Va        Vd 
##  1.579537 -1.257241</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="co">##############################</span></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="co">## REML method</span></span>
<span id="cb91-3"><a href="#cb91-3"></a><span class="co">##############################</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>mix2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(yield<span class="op">~</span><span class="st"> </span>setf <span class="op">+</span><span class="st"> </span>setf<span class="op">:</span>repf,</span>
<span id="cb91-5"><a href="#cb91-5"></a>            <span class="dt">random=</span><span class="op">~</span>femalef<span class="op">:</span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>malef<span class="op">:</span>setf, </span>
<span id="cb91-6"><a href="#cb91-6"></a>            <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb91-7"><a href="#cb91-7"></a>vc &lt;-<span class="st"> </span><span class="kw">summary</span>(mix2)<span class="op">$</span>varcomp; vc</span></code></pre></div>
<pre><code>##                                   VarComp  VarCompSE    Zratio Constraint
## femalef:malef:setf.yield-yield 0.08056338 0.08096526 0.9950364   Positive
## malef:setf.yield-yield         0.39480593 0.32832346 1.2024908   Positive
## units.yield-yield              0.10691762 0.04785610 2.2341480   Positive</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>Vfm &lt;-<span class="st"> </span>vc[<span class="dv">1</span>,<span class="st">&quot;VarComp&quot;</span>]</span>
<span id="cb93-2"><a href="#cb93-2"></a>Vm &lt;-<span class="st"> </span>vc[<span class="dv">2</span>,<span class="st">&quot;VarComp&quot;</span>]</span>
<span id="cb93-3"><a href="#cb93-3"></a></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="co">## Calculate Va and Vd</span></span>
<span id="cb93-5"><a href="#cb93-5"></a>Va=<span class="dv">4</span><span class="op">*</span>Vm <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb93-6"><a href="#cb93-6"></a>Vd=<span class="dv">4</span><span class="op">*</span>(Vfm<span class="op">-</span>Vm) <span class="co"># assuming no inbreeding(4/(1+F)^2)</span></span>
<span id="cb93-7"><a href="#cb93-7"></a>Vg=<span class="kw">c</span>(Va,Vd); <span class="kw">names</span>(Vg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Va&quot;</span>,<span class="st">&quot;Vd&quot;</span>); Vg</span></code></pre></div>
<pre><code>##        Va        Vd 
##  1.579224 -1.256970</code></pre>
<p>As can be seen the REML method is easier than manipulating the MS and we arrive to the same results.</p>
</div>
<div id="north-carolina-design-ii-factorial-design" class="section level4">
<h4>North Carolina Design II (Factorial design)</h4>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>DT &lt;-<span class="st"> </span>DT_expdesigns<span class="op">$</span>car2</span>
<span id="cb95-2"><a href="#cb95-2"></a>DT &lt;-<span class="st"> </span><span class="kw">aggregate</span>(yield<span class="op">~</span>set<span class="op">+</span>male<span class="op">+</span>female<span class="op">+</span>rep, <span class="dt">data=</span>DT, <span class="dt">FUN =</span> mean)</span>
<span id="cb95-3"><a href="#cb95-3"></a>DT<span class="op">$</span>setf &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>set)</span>
<span id="cb95-4"><a href="#cb95-4"></a>DT<span class="op">$</span>repf &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>rep)</span>
<span id="cb95-5"><a href="#cb95-5"></a>DT<span class="op">$</span>malef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>male)</span>
<span id="cb95-6"><a href="#cb95-6"></a>DT<span class="op">$</span>femalef &lt;-<span class="st"> </span><span class="kw">as.factor</span>(DT<span class="op">$</span>female)</span>
<span id="cb95-7"><a href="#cb95-7"></a><span class="kw">levelplot</span>(yield<span class="op">~</span>male<span class="op">*</span>female<span class="op">|</span>set, <span class="dt">data=</span>DT, <span class="dt">main=</span><span class="st">&quot;NC desing II&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">head</span>(DT)</span></code></pre></div>
<pre><code>##   set male female rep   yield setf repf malef femalef
## 1   1    1      1   1  831.03    1    1     1       1
## 2   1    2      1   1 1046.55    1    1     2       1
## 3   1    3      1   1  853.33    1    1     3       1
## 4   1    4      1   1  940.00    1    1     4       1
## 5   1    5      1   1  802.00    1    1     5       1
## 6   1    1      2   1  625.93    1    1     1       2</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>N=<span class="kw">with</span>(DT,<span class="kw">table</span>(female, male, set))</span>
<span id="cb98-2"><a href="#cb98-2"></a>nmale=<span class="kw">length</span>(<span class="kw">which</span>(N[<span class="dv">1</span>,,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb98-3"><a href="#cb98-3"></a>nfemale=<span class="kw">length</span>(<span class="kw">which</span>(N[,<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb98-4"><a href="#cb98-4"></a>nrep=<span class="kw">table</span>(N[,,<span class="dv">1</span>])</span>
<span id="cb98-5"><a href="#cb98-5"></a>nrep=<span class="kw">as.numeric</span>(<span class="kw">names</span>(nrep[<span class="kw">which</span>(<span class="kw">names</span>(nrep) <span class="op">!=</span><span class="dv">0</span>)]))</span>
<span id="cb98-6"><a href="#cb98-6"></a></span>
<span id="cb98-7"><a href="#cb98-7"></a><span class="co">##############################</span></span>
<span id="cb98-8"><a href="#cb98-8"></a><span class="co">## Expected Mean Square method</span></span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="co">##############################</span></span>
<span id="cb98-10"><a href="#cb98-10"></a></span>
<span id="cb98-11"><a href="#cb98-11"></a>mix1 &lt;-<span class="st"> </span><span class="kw">lm</span>(yield<span class="op">~</span><span class="st"> </span>setf <span class="op">+</span><span class="st"> </span>setf<span class="op">:</span>repf <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-12"><a href="#cb98-12"></a><span class="st">             </span>femalef<span class="op">:</span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>femalef<span class="op">:</span>setf, <span class="dt">data=</span>DT)</span>
<span id="cb98-13"><a href="#cb98-13"></a>MS &lt;-<span class="st"> </span><span class="kw">anova</span>(mix1); MS</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield
##                    Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## setf                1  847836  847836 45.6296 1.097e-09 ***
## setf:repf           4  144345   36086  1.9421  0.109652    
## setf:malef          8  861053  107632  5.7926 5.032e-06 ***
## setf:femalef        8  527023   65878  3.5455  0.001227 ** 
## setf:femalef:malef 32  807267   25227  1.3577  0.129527    
## Residuals          96 1783762   18581                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>ms1 &lt;-<span class="st"> </span>MS[<span class="st">&quot;setf:malef&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb100-2"><a href="#cb100-2"></a>ms2 &lt;-<span class="st"> </span>MS[<span class="st">&quot;setf:femalef&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb100-3"><a href="#cb100-3"></a>ms3 &lt;-<span class="st"> </span>MS[<span class="st">&quot;setf:femalef:malef&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb100-4"><a href="#cb100-4"></a>mse &lt;-<span class="st"> </span>MS[<span class="st">&quot;Residuals&quot;</span>,<span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb100-5"><a href="#cb100-5"></a>nrep=<span class="kw">length</span>(<span class="kw">unique</span>(DT<span class="op">$</span>rep))</span>
<span id="cb100-6"><a href="#cb100-6"></a>nfem=<span class="kw">length</span>(<span class="kw">unique</span>(DT<span class="op">$</span>female))</span>
<span id="cb100-7"><a href="#cb100-7"></a>nmal=<span class="kw">length</span>(<span class="kw">unique</span>(DT<span class="op">$</span>male))</span>
<span id="cb100-8"><a href="#cb100-8"></a>Vfm &lt;-<span class="st"> </span>(ms3<span class="op">-</span>mse)<span class="op">/</span>nrep; </span>
<span id="cb100-9"><a href="#cb100-9"></a>Vf &lt;-<span class="st"> </span>(ms2<span class="op">-</span>ms3)<span class="op">/</span>(nrep<span class="op">*</span>nmale); </span>
<span id="cb100-10"><a href="#cb100-10"></a>Vm &lt;-<span class="st"> </span>(ms1<span class="op">-</span>ms3)<span class="op">/</span>(nrep<span class="op">*</span>nfemale); </span>
<span id="cb100-11"><a href="#cb100-11"></a></span>
<span id="cb100-12"><a href="#cb100-12"></a>Va=<span class="dv">4</span><span class="op">*</span>Vm; <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb100-13"><a href="#cb100-13"></a>Va=<span class="dv">4</span><span class="op">*</span>Vf; <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb100-14"><a href="#cb100-14"></a>Vd=<span class="dv">4</span><span class="op">*</span>(Vfm); <span class="co"># assuming no inbreeding(4/(1+F)^2)</span></span>
<span id="cb100-15"><a href="#cb100-15"></a>Vg=<span class="kw">c</span>(Va,Vd); <span class="kw">names</span>(Vg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Va&quot;</span>,<span class="st">&quot;Vd&quot;</span>); Vg</span></code></pre></div>
<pre><code>##        Va        Vd 
## 10840.192  8861.659</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co">##############################</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="co">## REML method</span></span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="co">##############################</span></span>
<span id="cb102-4"><a href="#cb102-4"></a></span>
<span id="cb102-5"><a href="#cb102-5"></a>mix2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(yield<span class="op">~</span><span class="st"> </span>setf <span class="op">+</span><span class="st"> </span>setf<span class="op">:</span>repf ,</span>
<span id="cb102-6"><a href="#cb102-6"></a>            <span class="dt">random=</span><span class="op">~</span>femalef<span class="op">:</span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>malef<span class="op">:</span>setf <span class="op">+</span><span class="st"> </span>femalef<span class="op">:</span>setf, </span>
<span id="cb102-7"><a href="#cb102-7"></a>            <span class="dt">data=</span>DT)</span></code></pre></div>
<pre><code>## iteration    LogLik     wall    cpu(sec)   restrained
##     1      -47.2423   17:17:0      0           0
##     2      -46.9375   17:17:1      1           0
##     3      -46.8452   17:17:1      1           0
##     4      -46.8361   17:17:1      1           0
##     5      -46.836   17:17:1      1           0</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>vc &lt;-<span class="st"> </span><span class="kw">summary</span>(mix2)<span class="op">$</span>varcomp; vc</span></code></pre></div>
<pre><code>##                                  VarComp VarCompSE    Zratio Constraint
## femalef:malef:setf.yield-yield  2215.618  2284.794 0.9697231   Positive
## malef:setf.yield-yield          5493.338  3610.989 1.5212836   Positive
## femalef:setf.yield-yield        2710.176  2236.621 1.2117280   Positive
## units.yield-yield              18580.739  2681.742 6.9286068   Positive</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>Vfm &lt;-<span class="st"> </span>vc[<span class="dv">1</span>,<span class="st">&quot;VarComp&quot;</span>]</span>
<span id="cb106-2"><a href="#cb106-2"></a>Vm &lt;-<span class="st"> </span>vc[<span class="dv">2</span>,<span class="st">&quot;VarComp&quot;</span>]</span>
<span id="cb106-3"><a href="#cb106-3"></a>Vf &lt;-<span class="st"> </span>vc[<span class="dv">3</span>,<span class="st">&quot;VarComp&quot;</span>]</span>
<span id="cb106-4"><a href="#cb106-4"></a></span>
<span id="cb106-5"><a href="#cb106-5"></a>Va=<span class="dv">4</span><span class="op">*</span>Vm; <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb106-6"><a href="#cb106-6"></a>Va=<span class="dv">4</span><span class="op">*</span>Vf; <span class="co"># assuming no inbreeding (4/(1+F))</span></span>
<span id="cb106-7"><a href="#cb106-7"></a>Vd=<span class="dv">4</span><span class="op">*</span>(Vfm); <span class="co"># assuming no inbreeding(4/(1+F)^2)</span></span>
<span id="cb106-8"><a href="#cb106-8"></a>Vg=<span class="kw">c</span>(Va,Vd); <span class="kw">names</span>(Vg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Va&quot;</span>,<span class="st">&quot;Vd&quot;</span>); Vg</span></code></pre></div>
<pre><code>##        Va        Vd 
## 10840.704  8862.471</code></pre>
<p>As can be seen the REML method is easier than manipulating the MS and we arrive to the same results.</p>
</div>
</div>
<div id="dominance-variance" class="section level3">
<h3>4) Dominance variance</h3>
<p>The estimation of non-additive variance has been proposed to be a challenge since the additive and dominance relationship matrices are not orthogonal. In recent literature it has been proposed that the best practice to fit the dominance component is to fit the additive component first and then fix the value of that variance c</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="kw">data</span>(DT_cpdata)</span>
<span id="cb108-2"><a href="#cb108-2"></a>DT &lt;-<span class="st"> </span>DT_cpdata</span>
<span id="cb108-3"><a href="#cb108-3"></a>GT &lt;-<span class="st"> </span>GT_cpdata</span>
<span id="cb108-4"><a href="#cb108-4"></a>MP &lt;-<span class="st"> </span>MP_cpdata</span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="co">#### create the variance-covariance matrix</span></span>
<span id="cb108-6"><a href="#cb108-6"></a>A &lt;-<span class="st"> </span><span class="kw">A.mat</span>(GT) <span class="co"># additive relationship matrix</span></span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="co">#### look at the data and fit the model</span></span>
<span id="cb108-8"><a href="#cb108-8"></a>mix1 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb108-9"><a href="#cb108-9"></a>              <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id,<span class="dt">Gu=</span>A),</span>
<span id="cb108-10"><a href="#cb108-10"></a>              <span class="dt">rcov=</span><span class="op">~</span>units,</span>
<span id="cb108-11"><a href="#cb108-11"></a>              <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb108-12"><a href="#cb108-12"></a></span>
<span id="cb108-13"><a href="#cb108-13"></a><span class="co">####=========================================####</span></span>
<span id="cb108-14"><a href="#cb108-14"></a><span class="co">#### adding dominance and forcing the other VC&#39;s</span></span>
<span id="cb108-15"><a href="#cb108-15"></a><span class="co">####=========================================####</span></span>
<span id="cb108-16"><a href="#cb108-16"></a>DT<span class="op">$</span>idd &lt;-<span class="st"> </span>DT<span class="op">$</span>id;</span>
<span id="cb108-17"><a href="#cb108-17"></a>D &lt;-<span class="st"> </span><span class="kw">D.mat</span>(GT) <span class="co"># dominance relationship matrix</span></span>
<span id="cb108-18"><a href="#cb108-18"></a>mm &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>) <span class="co">## matrix to fix the var comp</span></span>
<span id="cb108-19"><a href="#cb108-19"></a></span>
<span id="cb108-20"><a href="#cb108-20"></a>mix2 &lt;-<span class="st"> </span><span class="kw">mmer</span>(Yield<span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb108-21"><a href="#cb108-21"></a>              <span class="dt">random=</span><span class="op">~</span><span class="kw">vs</span>(id, <span class="dt">Gu=</span>A, <span class="dt">Gti=</span>mix1<span class="op">$</span>sigma_scaled<span class="op">$</span><span class="st">`</span><span class="dt">u:id</span><span class="st">`</span>, <span class="dt">Gtc=</span>mm)</span>
<span id="cb108-22"><a href="#cb108-22"></a>                      <span class="op">+</span><span class="st"> </span><span class="kw">vs</span>(idd, <span class="dt">Gu=</span>D, <span class="dt">Gtc=</span><span class="kw">unsm</span>(<span class="dv">1</span>)),</span>
<span id="cb108-23"><a href="#cb108-23"></a>              <span class="dt">rcov=</span><span class="op">~</span><span class="kw">vs</span>(units,<span class="dt">Gti=</span>mix1<span class="op">$</span>sigma_scaled<span class="op">$</span>units, <span class="dt">Gtc=</span>mm),</span>
<span id="cb108-24"><a href="#cb108-24"></a>              <span class="dt">data=</span>DT, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb108-25"><a href="#cb108-25"></a></span>
<span id="cb108-26"><a href="#cb108-26"></a><span class="co"># analyze variance components</span></span>
<span id="cb108-27"><a href="#cb108-27"></a><span class="kw">summary</span>(mix1)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                     VarComp VarCompSE    Zratio Constraint
## u:id.Yield-Yield   650.4145  325.5562  1.997856   Positive
## units.Yield-Yield 4031.0153  344.6051 11.697493   Positive</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">summary</span>(mix2)<span class="op">$</span>varcomp</span></code></pre></div>
<pre><code>##                       VarComp VarCompSE     Zratio Constraint
## u:id.Yield-Yield     650.4145  504.0361  1.2904126      Fixed
## u:idd.Yield-Yield    220.6311  410.7679  0.5371186   Positive
## u:units.Yield-Yield 4031.0153  360.7322 11.1745357      Fixed</code></pre>
</div>
<div id="final-remarks" class="section level3">
<h3>Final remarks</h3>
<p>Keep in mind that sommer uses direct inversion (DI) algorithm which can be very slow for large datasets. The package is focused in problems of the type p &gt; n (more random effect levels than observations) and models with dense covariance structures. For example, for experiment with dense covariance structures with low-replication (i.e. 2000 records from 1000 individuals replicated twice with a covariance structure of 1000x1000) sommer will be faster than MME-based software. Also for genomic problems with large number of random effect levels, i.e. 300 individuals (n) with 100,000 genetic markers (p). For highly replicated trials with small covariance structures or n &gt; p (i.e. 2000 records from 200 individuals replicated 10 times with covariance structure of 200x200) asreml or other MME-based algorithms will be much faster and we recommend you to opt for those software. When datasets are big, the installation of the OpenBLAS library can make sommer quite fast and sometimes faster than asreml given the capacbility of sommer to take advantage of the multi-processor architecture of some systems.</p>
</div>
</div>
<div id="literature" class="section level2">
<h2>Literature</h2>
<p>Covarrubias-Pazaran G. 2016. Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6):1-15.</p>
<p>Covarrubias-Pazaran G. 2018. Software update: Moving the R package sommer to multivariate mixed models for genome-assisted prediction. doi: <a href="https://doi.org/10.1101/354639" class="uri">https://doi.org/10.1101/354639</a></p>
<p>Bernardo Rex. 2010. Breeding for quantitative traits in plants. Second edition. Stemma Press. 390 pp.</p>
<p>Gilmour et al. 1995. Average Information REML: An efficient algorithm for variance parameter estimation in linear mixed models. Biometrics 51(4):1440-1450.</p>
<p>Henderson C.R. 1975. Best Linear Unbiased Estimation and Prediction under a Selection Model. Biometrics vol. 31(2):423-447.</p>
<p>Kang et al. 2008. Efficient control of population structure in model organism association mapping. Genetics 178:1709-1723.</p>
<p>Lee, D.-J., Durban, M., and Eilers, P.H.C. (2013). Efficient two-dimensional smoothing with P-spline ANOVA mixed models and nested bases. Computational Statistics and Data Analysis, 61, 22 - 37.</p>
<p>Lee et al. 2015. MTG2: An efficient algorithm for multivariate linear mixed model analysis based on genomic information. Cold Spring Harbor. doi: <a href="http://dx.doi.org/10.1101/027201" class="uri">http://dx.doi.org/10.1101/027201</a>.</p>
<p>Maier et al. 2015. Joint analysis of psychiatric disorders increases accuracy of risk prediction for schizophrenia, bipolar disorder, and major depressive disorder. Am J Hum Genet; 96(2):283-294.</p>
<p>Rodriguez-Alvarez, Maria Xose, et al. Correcting for spatial heterogeneity in plant breeding experiments with P-splines. Spatial Statistics 23 (2018): 52-71.</p>
<p>Searle. 1993. Applying the EM algorithm to calculating ML and REML estimates of variance components. Paper invited for the 1993 American Statistical Association Meeting, San Francisco.</p>
<p>Yu et al. 2006. A unified mixed-model method for association mapping that accounts for multiple levels of relatedness. Genetics 38:203-208.</p>
<p>Tunnicliffe W. 1989. On the use of marginal likelihood in time series model estimation. JRSS 51(1):15-27.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
